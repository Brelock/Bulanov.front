let status="JS - OK!";function cl(e,t,n,o){return console.log(e,t||"",n||"",o||""),"-"}var glob={navMenuWrapper:null,navMenu:null,pageOverlay:null,scrollTopButton:null},globFunc={returnDOM:function(e){return e instanceof jQuery?e[0]:e},showOverlay:function(e,t,n){switch(e){case"popup":t.classList.contains("js_openPopup")||(t.style.zIndex=1150,t.style.visibility="visible",t.classList.add("js_openPopup"),t.classList.add("js_open"),n&&t.classList.add(n),document.body.classList.add("js_pageOverlayOpen"));break;case"menu":t.classList.contains("js_openMenu")||(t.style.zIndex=900,t.style.visibility="visible",t.classList.add("js_openMenu"),t.classList.add("js_open"),document.body.classList.add("js_pageOverlayOpen"))}},hideOverlay:function(e,t,n){switch(e){case"popup":t.classList.contains("js_openPopup")&&(t.classList.remove("js_openPopup"),t.classList.remove("js_open"),n&&t.classList.remove(n),document.body.classList.remove("js_pageOverlayOpen"),setTimeout(function(){t.classList.contains("js_openPopup")||(t.style.zIndex=-10,t.style.visibility="hidden")},300));break;case"menu":t.classList.contains("js_openMenu")&&(t.classList.remove("js_openMenu"),t.classList.remove("js_open"),document.body.classList.remove("js_pageOverlayOpen"),setTimeout(function(){t.classList.contains("js_openMenu")||(t.style.zIndex=-10,t.style.visibility="hidden")},300))}},toggleButtonContent:function(e,t){var n,o=this.returnDOM(e);t?n=t:e.dataset.text&&(n={default:e.dataset.text,active:e.dataset.textActive}),o.classList.contains("active")?(n&&(o.querySelector("span").innerHTML=n.default),o.classList.remove("active")):(n&&(o.querySelector("span").innerHTML=n.active),o.classList.add("active"))},dropDown:(e,t)=>{e.checked||e.classList.contains("active")?t.style.height=t.firstElementChild.offsetHeight+"px":t.style.height="0px"},animateBlock:function(e){let t=this;this.removeClassFrom(e,"js_animate"),setTimeout(function(){t.addClassTo(e,"js_animate")},50)},getCurrentYPosition:function(){return window.pageYOffset||document.documentElement.scrollTop},addClassTo:function(e,t){var n=this.returnDOM(e);n.classList.contains(t)||n.classList.add(t)},removeClassFrom:function(e,t){var n=this.returnDOM(e);n.classList.contains(t)&&n.classList.remove(t)},transitionHandler:function(e,t,n){e.propertyName&&console.log(e.propertyName),e.srcElement&&console.log(e.srcElement)},getChildsTotalWidth:function(e){let t=e.children,n=0;for(let e=0;e<t.length;e++)n+=t[e].offsetWidth;return n},getCoordsOnPage:function(e){var t=this.returnDOM(e).getBoundingClientRect();return{top:t.top+pageYOffset,left:t.left+pageXOffset,bottom:t.bottom+pageYOffset}},getCoordsOnScreen:function(e){var t=this.returnDOM(e).getBoundingClientRect();return{top:t.top,left:t.left,bottom:t.bottom,right:t.right,width:t.width,height:t.height}},openWidth:function(e){e.style.width=getChildsTotalWidth(e)+"px"},collapseWidth:function(e){e.style.width="0"},isVisible:function(e,t){let n;n=t||"whole";var o=window.pageYOffset,s=document.documentElement.clientHeight,i=e.getBoundingClientRect().top+pageYOffset,l=i+e.offsetHeight;return"whole"==n?document.documentElement.clientWidth>991?l<=o+s&&i>=o:i<=o+s/2&&i>=o:"topBorder"==n?i>=o+130&&i<=o+s:"topBorderIn"==n?i<=o+s:void 0},isVisibleOnXAxis:function(e,t){let n=e.getBoundingClientRect().left>t.getBoundingClientRect().left,o=e.getBoundingClientRect().right<t.getBoundingClientRect().right;return n&&o},isLastChild:function(e){return!e.nextElementSibling},isFirstChild:function(e){return!e.previousElementSibling}},test="include js error";$(document).ready(function(){console.log("document ready"),test="include js - OK",glob.navMenuWrapper=document.getElementById("navMenuWrapper"),glob.navMenu=document.getElementById("navMenu"),glob.pageOverlay=document.getElementById("pageOverlay"),$("body")||console.log("jQuery Error"),$(".dropdownButton").on("click",function(){globFunc.toggleButtonContent(this),globFunc.dropDown(this,glob.navMenuWrapper)}),$("body").on("click",".searchButton",function(){let e=$("#popupSearch");e.length&&glob.PopupModule.openPopup(e,"js_openPopup_search")}),$("body").on("click",".button",function(){let e=document.getElementById("id");e&&glob.PopupModule.openPopup(e)}),$(".description .ellipsis").dotdotdot({height:80,truncate:"word",watch:!0}),$(".title.ellipsis").dotdotdot({height:85,truncate:"word",watch:!0});var e=document.querySelectorAll(".description > p");if(e.length)for(var t=0;t<e.length;t++)!e[t].innerHTML&&e[t].parentElement.removeChild(e[t]);(window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth)<768&&($(".slideshow").slick({dots:!0,infinite:!0,speed:500,fade:!0,cssEase:"linear"}),$(".slide").slick({dots:!0,infinite:!1,speed:500,slidesToShow:4,slidesToScroll:4,responsive:[{breakpoint:1024,settings:{slidesToShow:3,slidesToScroll:3,infinite:!0,dots:!0}},{breakpoint:600,settings:{slidesToShow:2,slidesToScroll:2}},{breakpoint:480,settings:{slidesToShow:1,slidesToScroll:1}}]}))}),window.onload=function(){console.log("window load")};
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4LmpzIl0sIm5hbWVzIjpbInN0YXR1cyIsImNsIiwiYXJnMSIsImFyZzIiLCJhcmczIiwiYXJnNCIsImNvbnNvbGUiLCJsb2ciLCJnbG9iIiwibmF2TWVudVdyYXBwZXIiLCJuYXZNZW51IiwicGFnZU92ZXJsYXkiLCJzY3JvbGxUb3BCdXR0b24iLCJyZXR1cm5ET00iLCJlbGVtZW50IiwialF1ZXJ5Iiwic2hvd092ZXJsYXkiLCJvdmVybGF5VHlwZSIsIm92ZXJsYXlFbGVtZW50IiwiYWRkaXRpb25hbENsYXNzIiwiekluZGV4IiwiY29udGFpbnMiLCJzdHlsZSIsInZpc2liaWxpdHkiLCJjbGFzc0xpc3QiLCJhZGQiLCJkb2N1bWVudCIsImJvZHkiLCJoaWRlT3ZlcmxheSIsInJlbW92ZSIsInNldFRpbWVvdXQiLCJ0b2dnbGVCdXR0b25Db250ZW50IiwiYnV0dG9uRWxlbWVudCIsInN0ck9iaiIsInRleHQiLCJ0aGlzIiwiZGF0YXNldCIsImRlZmF1bHQiLCJidXR0b24iLCJidXR0b25BY3RpdmUiLCJxdWVyeVNlbGVjdG9yIiwiaW5uZXJIVE1MIiwiYWN0aXZlIiwiZHJvcERvd24iLCJ0YXJnZXRCbG9jayIsImNoZWNrZWQiLCJoZWlnaHQiLCJmaXJzdEVsZW1lbnRDaGlsZCIsIm9mZnNldEhlaWdodCIsImFuaW1hdGVCbG9jayIsInJlbW92ZUNsYXNzRnJvbSIsImJsb2NrIiwic2VsZiIsImFkZENsYXNzVG8iLCJnZXRDdXJyZW50WVBvc2l0aW9uIiwid2luZG93IiwicGFnZVlPZmZzZXQiLCJkb2N1bWVudEVsZW1lbnQiLCJzY3JvbGxUb3AiLCJhY3RpdmVDbGFzcyIsImVsZW0iLCJ0cmFuc2l0aW9uSGFuZGxlciIsImV2ZW50IiwiaGlkZGVuQ29udGVudCIsInByb3BlcnR5TmFtZSIsInNyY0VsZW1lbnQiLCJnZXRDaGlsZHNUb3RhbFdpZHRoIiwicGFyZW50IiwiY2hpbGRyZW4iLCJyZXN1bHQiLCJpIiwibGVuZ3RoIiwib2Zmc2V0V2lkdGgiLCJnZXRDb29yZHNPblBhZ2UiLCJib3giLCJnZXRCb3VuZGluZ0NsaWVudFJlY3QiLCJ0b3AiLCJsZWZ0IiwicGFnZVhPZmZzZXQiLCJib3R0b20iLCJnZXRDb29yZHNPblNjcmVlbiIsInJpZ2h0Iiwid2lkdGgiLCJvcGVuV2lkdGgiLCJjb2xsYXBzZVdpZHRoIiwiaXNWaXNpYmxlIiwib3B0aW9uIiwib3B0Iiwid2luZG93VG9wIiwid2luZG93SGVpZ2h0IiwiY2xpZW50SGVpZ2h0IiwiZWxlbVBhZ2VUb3AiLCJlbGVtUGFnZUJvdHRvbSIsImNsaWVudFdpZHRoIiwiaXNWaXNpYmxlT25YQXhpcyIsImlzVmlzaWJsZU9uTGVmdCIsImlzVmlzaWJsZU9uUmlnaHQiLCJpc0xhc3RDaGlsZCIsIm5leHRFbGVtZW50U2libGluZyIsImlzRmlyc3RDaGlsZCIsInByZXZpb3VzRWxlbWVudFNpYmxpbmciLCJ0ZXN0IiwicmVhZHkiLCJnZXRFbGVtZW50QnlJZCIsIiQiLCJvbiIsImdsb2JGdW5jIiwibW9kYWwiLCJQb3B1cE1vZHVsZSIsIm9wZW5Qb3B1cCIsImRvdGRvdGRvdCIsInRydW5jYXRlIiwid2F0Y2giLCJ0ZXh0QmxvY2tzIiwicXVlcnlTZWxlY3RvckFsbCIsInBhcmVudEVsZW1lbnQiLCJyZW1vdmVDaGlsZCIsImlubmVyV2lkdGgiLCJzbGljayIsImRvdHMiLCJpbmZpbml0ZSIsInNwZWVkIiwiZmFkZSIsImNzc0Vhc2UiLCJzbGlkZXNUb1Nob3ciLCJzbGlkZXNUb1Njcm9sbCIsInJlc3BvbnNpdmUiLCJicmVha3BvaW50Iiwic2V0dGluZ3MiLCJvbmxvYWQiXSwibWFwcGluZ3MiOiJBQUFBLElBQUlBLE9BQVMsV0FDYixTQUFTQyxHQUFHQyxFQUFNQyxFQUFNQyxFQUFNQyxHQUU3QixPQURBQyxRQUFRQyxJQUFJTCxFQUFNQyxHQUFRLEdBQUlDLEdBQVEsR0FBSUMsR0FBUSxJQUMzQyxJQU1SLElBQUlHLE1BQ0hDLGVBQWdCLEtBQ2hCQyxRQUFTLEtBQ1RDLFlBQWEsS0FFYkMsZ0JB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LFdBQVloRSxPQUFRLEdBQUlpRSxTQUFVLE9BQVFDLE9BQU8sSUFDN0VSLEVBQUUsbUJBQW1CTSxXQUFZaEUsT0FBUSxHQUFJaUUsU0FBVSxPQUFRQyxPQUFPLElBdUJ0RSxJQUFJQyxFQUFhdkYsU0FBU3dGLGlCQUFpQixvQkFFM0MsR0FBSUQsRUFBVzFDLE9BQ2QsSUFBSyxJQUFJRCxFQUFJLEVBQUdBLEVBQUkyQyxFQUFXMUMsT0FBUUQsS0FDdEMyQyxFQUFXM0MsR0FBRzdCLFdBQW1Cd0UsRUFBVzNDLEdBQUc2QyxjQUFjQyxZQUFZSCxFQUFXM0MsS0FjOUVmLE9BQU84RCxZQUNaM0YsU0FBUytCLGdCQUFnQm9DLGFBQ3pCbkUsU0FBU0MsS0FBS2tFLGFBQ1IsTUFDUlcsRUFBRSxjQUFjYyxPQUNmQyxNQUFNLEVBQ05DLFVBQVUsRUFDVkMsTUFBTyxJQUNQQyxNQUFNLEVBQ05DLFFBQVMsV0FHVm5CLEVBQUUsVUFBVWMsT0FTWEMsTUFBTSxFQUNOQyxVQUFVLEVBQ1ZDLE1BQU8sSUFDUEcsYUFBYyxFQUNkQyxlQUFnQixFQUNoQkMsYUFFQ0MsV0FBWSxLQUNaQyxVQUNFSixhQUFjLEVBQ2RDLGVBQWdCLEVBQ2hCTCxVQUFVLEVBQ1ZELE1BQU0sS0FJUlEsV0FBWSxJQUNaQyxVQUNFSixhQUFjLEVBQ2RDLGVBQWdCLEtBSWxCRSxXQUFZLElBQ1pDLFVBQ0VKLGFBQWMsRUFDZEMsZUFBZ0IsVUFZdEJ0RSxPQUFPMEUsT0FBUyxXQUNmM0gsUUFBUUMsSUFBSSIsImZpbGUiOiJpbmRleC5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyJsZXQgc3RhdHVzID0gXCJKUyAtIE9LIVwiO1xuZnVuY3Rpb24gY2woYXJnMSwgYXJnMiwgYXJnMywgYXJnNCkge1xuXHRjb25zb2xlLmxvZyhhcmcxLCBhcmcyIHx8ICcnLCBhcmczIHx8ICcnLCBhcmc0IHx8ICcnKTtcblx0cmV0dXJuICctJztcbn1cblxuLy8gY2woc3RhdHVzKTtcblxuXG52YXIgZ2xvYiA9IHtcblx0bmF2TWVudVdyYXBwZXI6IG51bGwsXG5cdG5hdk1lbnU6IG51bGwsXG5cdHBhZ2VPdmVybGF5OiBudWxsLFxuXG5cdHNjcm9sbFRvcEJ1dHRvbjogbnVsbCxcbn1cblxuLy8gPT09PT09PT09PT09PT09PT1cbnZhciBnbG9iRnVuYyA9IHtcbiAgcmV0dXJuRE9NOiBmdW5jdGlvbihlbGVtZW50KSB7XG4gICAgcmV0dXJuIGVsZW1lbnQgaW5zdGFuY2VvZiBqUXVlcnkgPyBlbGVtZW50WzBdIDogZWxlbWVudDtcbiAgfSxcblxuICBzaG93T3ZlcmxheTogZnVuY3Rpb24ob3ZlcmxheVR5cGUsIG92ZXJsYXlFbGVtZW50LCBhZGRpdGlvbmFsQ2xhc3MpIHtcbiAgICBzd2l0Y2ggKG92ZXJsYXlUeXBlKSB7XG4gICAgICBjYXNlIFwicG9wdXBcIjpcbiAgICAgICAgaWYgKCFvdmVybGF5RWxlbWVudC5jbGFzc0xpc3QuY29udGFpbnMoJ2pzX29wZW5Qb3B1cCcpKSB7XG4gICAgICAgICAgb3ZlcmxheUVsZW1lbnQuc3R5bGUuekluZGV4ID0gMTE1MDtcbiAgICAgICAgICBvdmVybGF5RWxlbWVudC5zdHlsZS52aXNpYmlsaXR5ID0gJ3Zpc2libGUnO1xuICAgICAgICAgIG92ZXJsYXlFbGVtZW50LmNsYXNzTGlzdC5hZGQoJ2pzX29wZW5Qb3B1cCcpO1xuICAgICAgICAgIG92ZXJsYXlFbGVtZW50LmNsYXNzTGlzdC5hZGQoJ2pzX29wZW4nKTtcbiAgICAgICAgICBcbiAgICAgICAgICBhZGRpdGlvbmFsQ2xhc3MgPyBvdmVybGF5RWxlbWVudC5jbGFzc0xpc3QuYWRkKGFkZGl0aW9uYWxDbGFzcykgOiBudWxsO1xuXG4gICAgICAgICAgZG9jdW1lbnQuYm9keS5jbGFzc0xpc3QuYWRkKFwianNfcGFnZU92ZXJsYXlPcGVuXCIpO1xuICAgICAgICB9IFxuICAgICAgYnJlYWs7XG5cbiAgICAgIGNhc2UgXCJtZW51XCI6XG4gICAgICAgIGlmICghb3ZlcmxheUVsZW1lbnQuY2xhc3NMaXN0LmNvbnRhaW5zKCdqc19vcGVuTWVudScpKSB7XG4gICAgICAgICAgb3ZlcmxheUVsZW1lbnQuc3R5bGUuekluZGV4ID0gOTAwO1xuICAgICAgICAgIG92ZXJsYXlFbGVtZW50LnN0eWxlLnZpc2liaWxpdHkgPSAndmlzaWJsZSc7XG4gICAgICAgICAgb3ZlcmxheUVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnanNfb3Blbk1lbnUnKTtcbiAgICAgICAgICBvdmVybGF5RWxlbWVudC5jbGFzc0xpc3QuYWRkKCdqc19vcGVuJyk7XG4gICAgICAgICAgZG9jdW1lbnQuYm9keS5jbGFzc0xpc3QuYWRkKFwianNfcGFnZU92ZXJsYXlPcGVuXCIpO1xuICAgICAgICB9IFxuICAgICAgYnJlYWs7XG4gICAgfVxuICB9LFxuICBoaWRlT3ZlcmxheTogZnVuY3Rpb24ob3ZlcmxheVR5cGUsIG92ZXJsYXlFbGVtZW50LCBhZGRpdGlvbmFsQ2xhc3MpIHtcbiAgICBzd2l0Y2ggKG92ZXJsYXlUeXBlKSB7XG4gICAgICBjYXNlIFwicG9wdXBcIjpcbiAgICAgICAgaWYgKG92ZXJsYXlFbGVtZW50LmNsYXNzTGlzdC5jb250YWlucygnanNfb3BlblBvcHVwJykpIHtcbiAgICAgICAgICBvdmVybGF5RWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKCdqc19vcGVuUG9wdXAnKTtcbiAgICAgICAgICBvdmVybGF5RWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKCdqc19vcGVuJyk7XG5cbiAgICAgICAgICBhZGRpdGlvbmFsQ2xhc3MgPyBvdmVybGF5RWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKGFkZGl0aW9uYWxDbGFzcykgOiBudWxsO1xuXG4gICAgICAgICAgZG9jdW1lbnQuYm9keS5jbGFzc0xpc3QucmVtb3ZlKFwianNfcGFnZU92ZXJsYXlPcGVuXCIpO1xuICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaWYgKCFvdmVybGF5RWxlbWVudC5jbGFzc0xpc3QuY29udGFpbnMoJ2pzX29wZW5Qb3B1cCcpKSB7XG4gICAgICAgICAgICAgIG92ZXJsYXlFbGVtZW50LnN0eWxlLnpJbmRleCA9IC0xMDtcbiAgICAgICAgICAgICAgb3ZlcmxheUVsZW1lbnQuc3R5bGUudmlzaWJpbGl0eSA9ICdoaWRkZW4nO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0sIDMwMClcbiAgICAgICAgfVxuICAgICAgYnJlYWs7XG5cbiAgICAgIGNhc2UgXCJtZW51XCI6XG4gICAgICAgIGlmIChvdmVybGF5RWxlbWVudC5jbGFzc0xpc3QuY29udGFpbnMoJ2pzX29wZW5NZW51JykpIHtcbiAgICAgICAgICBvdmVybGF5RWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKCdqc19vcGVuTWVudScpO1xuICAgICAgICAgIG92ZXJsYXlFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoJ2pzX29wZW4nKTtcbiAgICAgICAgICBkb2N1bWVudC5ib2R5LmNsYXNzTGlzdC5yZW1vdmUoXCJqc19wYWdlT3ZlcmxheU9wZW5cIik7XG4gICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBpZiAoIW92ZXJsYXlFbGVtZW50LmNsYXNzTGlzdC5jb250YWlucygnanNfb3Blbk1lbnUnKSkge1xuICAgICAgICAgICAgICBvdmVybGF5RWxlbWVudC5zdHlsZS56SW5kZXggPSAtMTA7XG4gICAgICAgICAgICAgIG92ZXJsYXlFbGVtZW50LnN0eWxlLnZpc2liaWxpdHkgPSAnaGlkZGVuJztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9LCAzMDApXG4gICAgICAgIH1cbiAgICAgIGJyZWFrO1xuICAgIH1cbiAgfSxcblxuICB0b2dnbGVCdXR0b25Db250ZW50OiBmdW5jdGlvbiAoYnV0dG9uRWxlbWVudCwgc3RyT2JqKSB7XG4gICAgdmFyIGJ1dHRvbiA9IHRoaXMucmV0dXJuRE9NKGJ1dHRvbkVsZW1lbnQpO1xuICAgIHZhciB0ZXh0O1xuXG4gICAgLy8gY29uc29sZS5sb2coYnV0dG9uRWxlbWVudClcblxuICAgIGlmIChzdHJPYmopIHsgdGV4dCA9IHN0ck9iaiB9IGVsc2UgaWYgKGJ1dHRvbkVsZW1lbnQuZGF0YXNldC50ZXh0KSB7XG4gICAgICB0ZXh0ID0ge1xuICAgICAgICBkZWZhdWx0OiBidXR0b25FbGVtZW50LmRhdGFzZXQudGV4dCxcbiAgICAgICAgYWN0aXZlOiBidXR0b25FbGVtZW50LmRhdGFzZXQudGV4dEFjdGl2ZVxuICAgICAgfVxuICAgIH1cbiAgICBsZXQgYnV0dG9uQWN0aXZlID0gYnV0dG9uLmNsYXNzTGlzdC5jb250YWlucygnYWN0aXZlJyk7XG5cbiAgICBpZiAoYnV0dG9uQWN0aXZlKSB7XG4gICAgICB0ZXh0ID8gYnV0dG9uLnF1ZXJ5U2VsZWN0b3IoJ3NwYW4nKS5pbm5lckhUTUwgPSB0ZXh0LmRlZmF1bHQgOiBudWxsO1xuICAgICAgYnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpO1xuXG4gICAgfSBlbHNlIHtcbiAgICAgIHRleHQgPyBidXR0b24ucXVlcnlTZWxlY3Rvcignc3BhbicpLmlubmVySFRNTCA9IHRleHQuYWN0aXZlIDogbnVsbDtcbiAgICAgIGJ1dHRvbi5jbGFzc0xpc3QuYWRkKCdhY3RpdmUnKTtcbiAgICB9XG4gIH0sXG5cbiAgZHJvcERvd246IChidXR0b24sIHRhcmdldEJsb2NrKSA9PiB7XG4gICAgYnV0dG9uLmNoZWNrZWQgfHwgYnV0dG9uLmNsYXNzTGlzdC5jb250YWlucygnYWN0aXZlJykgPyBcbiAgICB0YXJnZXRCbG9jay5zdHlsZS5oZWlnaHQgPSB0YXJnZXRCbG9jay5maXJzdEVsZW1lbnRDaGlsZC5vZmZzZXRIZWlnaHQgKyAncHgnIDpcbiAgICB0YXJnZXRCbG9jay5zdHlsZS5oZWlnaHQgPSBcIjBweFwiOyAgICBcbiAgfSxcblxuICBhbmltYXRlQmxvY2s6IGZ1bmN0aW9uIChibG9jaykge1xuICAgIGxldCBzZWxmID0gdGhpcztcbiAgICB0aGlzLnJlbW92ZUNsYXNzRnJvbShibG9jaywgJ2pzX2FuaW1hdGUnKTtcbiAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge3NlbGYuYWRkQ2xhc3NUbyhibG9jaywgJ2pzX2FuaW1hdGUnKSB9LCA1MClcbiAgfSxcblxuICBnZXRDdXJyZW50WVBvc2l0aW9uOiBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gd2luZG93LnBhZ2VZT2Zmc2V0IHx8IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zY3JvbGxUb3A7XG4gIH0sXG5cbiAgYWRkQ2xhc3NUbzogZnVuY3Rpb24oZWxlbWVudCwgYWN0aXZlQ2xhc3MpIHtcbiAgICB2YXIgZWxlbSA9IHRoaXMucmV0dXJuRE9NKGVsZW1lbnQpO1xuICAgIGlmICghZWxlbS5jbGFzc0xpc3QuY29udGFpbnMoYWN0aXZlQ2xhc3MpKSB7XG4gICAgICBlbGVtLmNsYXNzTGlzdC5hZGQoYWN0aXZlQ2xhc3MpO1xuICAgIH1cbiAgfSxcbiAgcmVtb3ZlQ2xhc3NGcm9tOiBmdW5jdGlvbihlbGVtZW50LCBhY3RpdmVDbGFzcykge1xuICAgIHZhciBlbGVtID0gdGhpcy5yZXR1cm5ET00oZWxlbWVudCk7XG4gICAgaWYgKGVsZW0uY2xhc3NMaXN0LmNvbnRhaW5zKGFjdGl2ZUNsYXNzKSkge1xuICAgICAgZWxlbS5jbGFzc0xpc3QucmVtb3ZlKGFjdGl2ZUNsYXNzKTtcbiAgICB9XG4gIH0sXG5cbiAgdHJhbnNpdGlvbkhhbmRsZXI6IGZ1bmN0aW9uKGV2ZW50LCB0YXJnZXRCbG9jaywgaGlkZGVuQ29udGVudCkge1xuICAgIGlmIChldmVudC5wcm9wZXJ0eU5hbWUpIHtcbiAgICAgIGNvbnNvbGUubG9nKGV2ZW50LnByb3BlcnR5TmFtZSkgIC8vIHlvdXIgY29kZSBoZXJlXG4gICAgfVxuXG4gICAgaWYgKGV2ZW50LnNyY0VsZW1lbnQpIHtcbiAgICAgIGNvbnNvbGUubG9nKGV2ZW50LnNyY0VsZW1lbnQpICAvLyB5b3VyIGNvZGUgaGVyZVxuICAgIH1cbiAgfSxcblxuICBnZXRDaGlsZHNUb3RhbFdpZHRoOiBmdW5jdGlvbihwYXJlbnQpIHtcbiAgICBsZXQgY2hpbGRyZW4gPSBwYXJlbnQuY2hpbGRyZW47XG4gICAgbGV0IHJlc3VsdCA9IDA7XG5cbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNoaWxkcmVuLmxlbmd0aDsgaSsrKSB7XG4gICAgICByZXN1bHQgPSByZXN1bHQgKyBjaGlsZHJlbltpXS5vZmZzZXRXaWR0aDtcbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfSxcblxuICBnZXRDb29yZHNPblBhZ2U6IGZ1bmN0aW9uKGVsZW1lbnQpIHsgXG4gICAgdmFyIGVsZW0gPSB0aGlzLnJldHVybkRPTShlbGVtZW50KTtcbiAgICB2YXIgYm94ID0gZWxlbS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcblxuICAgIHJldHVybiB7XG4gICAgICB0b3A6IGJveC50b3AgKyBwYWdlWU9mZnNldCxcbiAgICAgIGxlZnQ6IGJveC5sZWZ0ICsgcGFnZVhPZmZzZXQsXG4gICAgICBib3R0b206IGJveC5ib3R0b20gKyBwYWdlWU9mZnNldFxuICAgIH07XG4gIH0sXG5cbiAgZ2V0Q29vcmRzT25TY3JlZW46IGZ1bmN0aW9uKGVsZW1lbnQpIHtcbiAgICB2YXIgZWxlbSA9IHRoaXMucmV0dXJuRE9NKGVsZW1lbnQpO1xuICAgIHZhciBib3ggPSBlbGVtLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuXG4gICAgcmV0dXJuIHtcbiAgICAgIHRvcDogYm94LnRvcCxcbiAgICAgIGxlZnQ6IGJveC5sZWZ0LFxuICAgICAgYm90dG9tOiBib3guYm90dG9tLFxuICAgICAgcmlnaHQ6IGJveC5yaWdodCxcbiAgICAgIHdpZHRoOiBib3gud2lkdGgsXG4gICAgICBoZWlnaHQ6IGJveC5oZWlnaHQsXG4gICAgfTtcbiAgfSxcblxuICBvcGVuV2lkdGg6IGZ1bmN0aW9uKGVsZW1lbnQpIHtcbiAgICBlbGVtZW50LnN0eWxlLndpZHRoID0gZ2V0Q2hpbGRzVG90YWxXaWR0aChlbGVtZW50KSArICdweCc7XG4gIH0sXG4gIGNvbGxhcHNlV2lkdGg6IGZ1bmN0aW9uKGVsZW1lbnQpIHtcbiAgICBlbGVtZW50LnN0eWxlLndpZHRoID0gJzAnO1xuICB9LFxuXG4gIGlzVmlzaWJsZTogZnVuY3Rpb24oZWxlbSwgb3B0aW9uKSB7XG4gICAgLy8gdmFyIGVsZW0gPSB0aGlzLnJldHVybkRPTShlbGVtZW50KTtcbiAgICBsZXQgb3B0O1xuICAgIG9wdGlvbiA/IG9wdCA9IG9wdGlvbiA6IG9wdCA9IFwid2hvbGVcIjtcbiAgICB2YXIgd2luZG93VG9wID0gd2luZG93LnBhZ2VZT2Zmc2V0O1xuICAgIHZhciB3aW5kb3dIZWlnaHQgPSBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xpZW50SGVpZ2h0O1xuICAgIHZhciBlbGVtUGFnZVRvcCA9IGVsZW0uZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkudG9wICsgcGFnZVlPZmZzZXQ7XG4gICAgdmFyIGVsZW1QYWdlQm90dG9tID0gZWxlbVBhZ2VUb3AgKyBlbGVtLm9mZnNldEhlaWdodDtcblxuICAgIGlmIChvcHQgPT0gXCJ3aG9sZVwiKSB7XG4gICAgICBpZiAoZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsaWVudFdpZHRoID4gOTkxKSB7XG4gICAgICAgIHJldHVybiAoZWxlbVBhZ2VCb3R0b20gPD0gd2luZG93VG9wICsgd2luZG93SGVpZ2h0KSAmJiAoZWxlbVBhZ2VUb3AgPj0gd2luZG93VG9wKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiAoIGVsZW1QYWdlVG9wIDw9ICh3aW5kb3dUb3AgKyB3aW5kb3dIZWlnaHQgLyAyKSApICYmIChlbGVtUGFnZVRvcCA+PSB3aW5kb3dUb3ApO1xuICAgICAgfVxuICAgIH1cblxuICAgIGlmIChvcHQgPT0gXCJ0b3BCb3JkZXJcIikge1xuICAgICAgLy8gY29uc29sZS5sb2cod2luZG93VG9wKVxuICAgICAgcmV0dXJuIChlbGVtUGFnZVRvcCA+PSB3aW5kb3dUb3AgKyAxMzApICYmIChlbGVtUGFnZVRvcCA8PSB3aW5kb3dUb3AgKyB3aW5kb3dIZWlnaHQpO1xuICAgIH1cblxuICAgIGlmIChvcHQgPT0gXCJ0b3BCb3JkZXJJblwiKSB7XG4gICAgICByZXR1cm4gZWxlbVBhZ2VUb3AgPD0gd2luZG93VG9wICsgd2luZG93SGVpZ2h0O1xuICAgIH1cblxuICAgIGlmIChvcHQgPT0gXCJib3R0b21Cb3JkZXJcIikge1xuICAgICAgLy8gcmV0dXJuIGVsZW1QYWdlVG9wID49IHdpbmRvd1RvcCArIDEwO1xuICAgIH1cbiAgfSxcblxuICBpc1Zpc2libGVPblhBeGlzOiBmdW5jdGlvbihlbGVtZW50LCBwYXJlbnQpIHtcbiAgICBsZXQgaXNWaXNpYmxlT25MZWZ0ID0gZWxlbWVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS5sZWZ0ID4gcGFyZW50LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLmxlZnQ7XG4gICAgbGV0IGlzVmlzaWJsZU9uUmlnaHQgPSBlbGVtZW50LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLnJpZ2h0IDwgcGFyZW50LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLnJpZ2h0O1xuICAgIHJldHVybiBpc1Zpc2libGVPbkxlZnQgJiYgaXNWaXNpYmxlT25SaWdodDtcbiAgfSxcblxuICBpc0xhc3RDaGlsZDogZnVuY3Rpb24oZWxlbWVudCkge1xuICAgIHJldHVybiBlbGVtZW50Lm5leHRFbGVtZW50U2libGluZyA/IGZhbHNlIDogdHJ1ZTtcbiAgfSxcbiAgaXNGaXJzdENoaWxkOiBmdW5jdGlvbihlbGVtZW50KSB7XG4gICAgcmV0dXJuIGVsZW1lbnQucHJldmlvdXNFbGVtZW50U2libGluZyA/IGZhbHNlIDogdHJ1ZTtcbiAgfSxcbn1cbi8vID09PT09PT09PT09PT09PVxuXG5cbnZhciB0ZXN0ID0gJ2luY2x1ZGUganMgZXJyb3InO1xuXG4vLyBpbXBvcnQgeyBkcm9wRG93biB9IGZyb20gJy4vZnJhbWVzL2dsb2JhbEZ1bmN0aW9ucydcblxuJChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24oKSB7XG5cdGNvbnNvbGUubG9nKCdkb2N1bWVudCByZWFkeScpXG5cdC8vIGNvbnNvbGUubG9nKGRyb3BEb3duKVx0XG5cdC8vID09PT09PT09PT09PT09PT09SW5jbHVkZSBNb2R1bGVzPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cblx0dGVzdCA9ICdpbmNsdWRlIGpzIC0gT0snO1xuXG5cbiAgLyovLyBjb25zb2xlLmxvZygnUG9wdXBNb2R1bGUgb2snKTtcbi8vID09PT09PT09PT09PT09UG9wdXAgT3Blbi9DbG9zZSBNb2R1bGUgPT09PT09PT09PT09PT1cbmdsb2IuUG9wdXBNb2R1bGUgPSAoZnVuY3Rpb24gKCkge1xuICB2YXIgYWRkaXRpb25hbENsYXNzU3RyO1xuICBsZXQgbW9kYWxzID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgncG9wdXAnKTtcbiAgY29uc3QgcGFnZU92ZXJsYXkgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncGFnZU92ZXJsYXknKTtcblxuXG4gIGZ1bmN0aW9uIHRvZ2dsZVNob3coZXZlbnQsIHBvcHVwQmxvY2spIHtcbiAgICB2YXIgcG9wdXAgPSBnbG9iRnVuYy5yZXR1cm5ET00ocG9wdXBCbG9jayk7XG5cbiAgICBpZiAoIGV2ZW50LnByb3BlcnR5TmFtZSA9PSAndHJhbnNmb3JtJyB8fCAgZXZlbnQucHJvcGVydHlOYW1lID09ICdvcGFjaXR5Jykge1xuICAgICAgcG9wdXAuY2xhc3NMaXN0LmNvbnRhaW5zKCdqc19hbmltYXRlJykgPyBudWxsIDogcG9wdXAuY2xhc3NMaXN0LnJlbW92ZSgnanNfb3BlbicpO1xuICAgIH1cbiAgfVxuXG4gIGlmIChtb2RhbHMubGVuZ3RoKSB7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBtb2RhbHMubGVuZ3RoOyBpKyspIHtcbiAgICAgIG1vZGFsc1tpXS5hZGRFdmVudExpc3RlbmVyKFwidHJhbnNpdGlvbmVuZFwiLCBmdW5jdGlvbihldmVudCkge1xuICAgICAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgdG9nZ2xlU2hvdyhldmVudCwgbW9kYWxzW2ldKVxuICAgICAgfSwgZmFsc2UpO1xuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIG9wZW5Qb3B1cChwb3B1cEJsb2NrLCBhZGRpdGlvbmFsQ2xhc3MsIG92ZXJsYXlCbG9jaykge1xuICAgIGxldCBvdmVybGF5ID0gb3ZlcmxheUJsb2NrIHx8IHBhZ2VPdmVybGF5O1xuXG4gICAgdmFyIHBvcHVwID0gZ2xvYkZ1bmMucmV0dXJuRE9NKHBvcHVwQmxvY2spO1xuICAgICAgICBwb3B1cC5jbGFzc0xpc3QuYWRkKFwianNfb3BlblwiKTtcbiAgICAgICAgcG9wdXAuY2xhc3NMaXN0LmFkZChcImpzX2FuaW1hdGVcIik7XG5cbiAgICBpZiAoYWRkaXRpb25hbENsYXNzKSB7XG4gICAgICBhZGRpdGlvbmFsQ2xhc3NTdHIgPSBhZGRpdGlvbmFsQ2xhc3M7XG4gICAgICBnbG9iRnVuYy5zaG93T3ZlcmxheShcInBvcHVwXCIsIG92ZXJsYXksIGFkZGl0aW9uYWxDbGFzcykgXG4gICAgfSBlbHNlIHtcbiAgICAgIGdsb2JGdW5jLnNob3dPdmVybGF5KFwicG9wdXBcIiwgb3ZlcmxheSk7XG4gICAgfVxuICB9XG5cbiAgZnVuY3Rpb24gY2xvc2VQb3B1cChwb3B1cEJsb2NrKSB7XG4gICAgLy8gbGV0IG92ZXJsYXkgPSBvdmVybGF5QmxvY2sgfHwgcGFnZU92ZXJsYXk7XG4gICAgdmFyIHBvcHVwID0gZ2xvYkZ1bmMucmV0dXJuRE9NKHBvcHVwQmxvY2spO1xuICAgIFxuICAgIHBvcHVwLmNsYXNzTGlzdC5yZW1vdmUoXCJqc19hbmltYXRlXCIpO1xuICAgIC8vIHBvcHVwLmNsYXNzTGlzdC5yZW1vdmUoXCJqc19vcGVuXCIpO1xuICAgIC8vIGFkZGl0aW9uYWxDbGFzcyA/IGhpZGVPdmVybGF5KFwicG9wdXBcIiwgb3ZlcmxheSwgYWRkaXRpb25hbENsYXNzKSA6IGhpZGVPdmVybGF5KFwicG9wdXBcIiwgb3ZlcmxheSk7XG4gIH1cblxuICAvLyAtLS0tLS0tRXZlbnRzLS0tLS0tLS0gIFxuXG4gICQoJ2JvZHknKS5vbignY2xpY2snLCAnI3BhZ2VPdmVybGF5JywgZnVuY3Rpb24oZSkge1xuICAgIC8vIGNvbnNvbGUubG9nKGUpXG4gICAgZ2xvYkZ1bmMuaGlkZU92ZXJsYXkoXCJwb3B1cFwiLCB0aGlzLCBhZGRpdGlvbmFsQ2xhc3NTdHIpO1xuXG4gICAgaWYgKG1vZGFscykge1xuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBtb2RhbHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgbW9kYWxzW2ldLmNsYXNzTGlzdC5jb250YWlucygnanNfb3BlbicpID8gY2xvc2VQb3B1cChtb2RhbHNbaV0pIDogbnVsbDtcbiAgICAgIH0gICAgICAgXG4gICAgfVxuICB9KTtcbiAgIFxuICAkKCdib2R5Jykub24oJ2NsaWNrJywgJ2J1dHRvbi5wb3B1cENsb3NlQnV0dG9uJywgZnVuY3Rpb24oKSB7XG4gICAgLy8gY29uc29sZS5sb2coJ29rJylcblxuICAgIGNsb3NlUG9wdXAoICQodGhpcykuY2xvc2VzdCgnLnBvcHVwJykgKTtcbiAgICBnbG9iRnVuYy5oaWRlT3ZlcmxheShcInBvcHVwXCIsIHBhZ2VPdmVybGF5LCBhZGRpdGlvbmFsQ2xhc3NTdHIpO1xuICB9KTtcblxuICAkKCdib2R5Jykub24oJ21vdXNlZG93bicsICcucG9wdXAnLCBmdW5jdGlvbihlKSB7XG4gICAgLy8gY29uc29sZS5sb2coZS50YXJnZXQpXG4gICAgaWYgKGUudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygncG9wdXAnKSkge1xuICAgICAgY2xvc2VQb3B1cCggZS50YXJnZXQgKTtcbiAgICAgIGdsb2JGdW5jLmhpZGVPdmVybGF5KFwicG9wdXBcIiwgcGFnZU92ZXJsYXksIGFkZGl0aW9uYWxDbGFzc1N0cik7XG4gICAgfVxuICB9KTtcblxuICB3aW5kb3cub25rZXlkb3duID0gZnVuY3Rpb24gKGUpIHtcbiAgICBpZiAoZS5rZXlDb2RlID09PSAyNyApIHtcbiAgICAgIGlmIChwYWdlT3ZlcmxheSkge1xuICAgICAgICBwYWdlT3ZlcmxheS5jbGFzc0xpc3QuY29udGFpbnMoJ2pzX29wZW4nKSA/IGdsb2JGdW5jLmhpZGVPdmVybGF5KFwicG9wdXBcIiwgcGFnZU92ZXJsYXksIGFkZGl0aW9uYWxDbGFzc1N0cikgOiBudWxsO1xuICAgICAgfVxuXG4gICAgICBpZiAobW9kYWxzKSB7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbW9kYWxzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgbW9kYWxzW2ldLmNsYXNzTGlzdC5jb250YWlucygnanNfb3BlbicpID8gY2xvc2VQb3B1cChtb2RhbHNbaV0pIDogbnVsbDtcbiAgICAgICAgfSAgICAgICBcbiAgICAgIH1cbiAgICB9XG4gIH07XG5cbiAgLy8gLS0tLS0tLS0tLS0tXG5cbiAgcmV0dXJuIHtcbiAgICBvcGVuUG9wdXA6IG9wZW5Qb3B1cCxcbiAgICBjbG9zZVBvcHVwOiBjbG9zZVBvcHVwLFxuICB9XG5cbn0pKCk7XG5cbi8vIGdsb2IuUG9wdXBNb2R1bGUoKVxuXG4vLyAoZnVuY3Rpb24oKSB7XG5cblxuXG4vLyB9KS5jYWxsKGdsb2IuUG9wdXBNb2R1bGUucHJvdG90eXBlKSovXG4gIC8qVmFsaWRhdGlvbk1vZHVsZSA9IChmdW5jdGlvbigpIHtcblx0ZnVuY3Rpb24gdmFsaWRhdGUoaW5wdXRFbGVtZW50LCB2YWxpZGF0aW9uc0FycmF5KSB7XG5cdFx0Y29uc3QgdmFsaWRhdGlvbnMgPSB2YWxpZGF0aW9uc0FycmF5O1xuXHRcdGxldCBtZXNzYWdlcyA9IFtdO1xuXG5cdFx0ZnVuY3Rpb24gaXNOdW1iZXIoaW5wdXQpIHtcblx0XHRcdHJldHVybiAhaXNOYU4ocGFyc2VGbG9hdChpbnB1dC52YWx1ZSkpICYmIGlzRmluaXRlKGlucHV0LnZhbHVlKTtcblx0XHR9XG5cblx0XHRmdW5jdGlvbiBpc0VtYWlsKGlucHV0KSB7XG5cdFx0XHR2YXIgcmVnZXggPSAvXihbYS16QS1aMC05Xy4rLV0pK1xcQCgoW2EtekEtWjAtOS1dKStcXC4pKyhbYS16QS1aMC05XXsyLDR9KSskLztcblx0XHRcdFxuXHRcdFx0cmV0dXJuIHJlZ2V4LnRlc3QoaW5wdXQudmFsdWUpO1xuXHRcdH1cblxuXHRcdGZ1bmN0aW9uIGlzRW1wdHkoaW5wdXQpIHtcblx0XHRcdHJldHVybiBpbnB1dC52YWx1ZS5yZXBsYWNlKC9cXHMvZyxcIlwiKS5sZW5ndGggPyBmYWxzZSA6IHRydWU7XG5cdFx0fVxuXG5cdFx0Ly8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cblx0XHRmb3IgKGxldCBpID0gMDsgaSA8IHZhbGlkYXRpb25zLmxlbmd0aDsgaSsrKSB7XG5cblx0XHRcdHN3aXRjaCAodmFsaWRhdGlvbnNbaV0pIHtcblx0XHRcdFx0Y2FzZSAncmVxdWlyZWQnOiBcblx0XHRcdFx0XHRpZiAoIGlzRW1wdHkoaW5wdXRFbGVtZW50KSApIHtcblx0XHRcdFx0XHRcdG1lc3NhZ2VzLnB1c2goaW5wdXRFbGVtZW50LmRhdGFzZXQuZXJyb3JUZXh0KVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0YnJlYWs7XG5cblx0XHRcdFx0Y2FzZSAnaXNOdW1iZXInOiBcblx0XHRcdFx0XHRpZiAoICFpc051bWJlcihpbnB1dEVsZW1lbnQpICkge1xuXHRcdFx0XHRcdFx0bWVzc2FnZXMucHVzaChpbnB1dEVsZW1lbnQuZGF0YXNldC5lcnJvclRleHQpXG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRicmVhaztcblxuXHRcdFx0XHRjYXNlICdpc0VtYWlsJzogXG5cdFx0XHRcdFx0aWYgKCAhaXNFbWFpbChpbnB1dEVsZW1lbnQpICkge1xuXHRcdFx0XHRcdFx0bWVzc2FnZXMucHVzaChpbnB1dEVsZW1lbnQuZGF0YXNldC5lcnJvclRleHQpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0YnJlYWs7XG5cblx0XHRcdFx0ZGVmYXVsdDogY29uc29sZS5lcnJvcignaW52YWxpZCBpbnB1dCBkYXRhLXZhbGlkYXRlIHZhbHVlJylcblxuXHRcdFx0fVxuXHRcdH1cblx0XHQvLyBjb25zb2xlLmxvZyhtZXNzYWdlcy5sZW5ndGggPyBtZXNzYWdlcyA6IG51bGwpXG5cdFx0cmV0dXJuIG1lc3NhZ2VzLmxlbmd0aCA/IG1lc3NhZ2VzIDogbnVsbDtcblx0fVxuXG5cdGZ1bmN0aW9uIHNob3dXYXJuaW5nKGlucHV0RWxlbWVudCwgbWVzc2FnZXMsIHRleHRDb2xvcikge1xuXHRcdGlucHV0RWxlbWVudC5jbGFzc0xpc3QuYWRkKCdqc19jb250YWluc0Vycm9yJyk7XG5cdFx0bGV0IHdhcm5pbmdMaXN0ID0gJCgnPHVsIGNsYXNzPVwianNfd2FybmluZy1saXN0XCI+PC91bD4nKTtcblxuXHRcdGZvciAobGV0IGkgPSAwOyBpIDwgbWVzc2FnZXMubGVuZ3RoOyBpKyspIHtcblx0XHRcdGxldCBsaXN0RWxlbWVudCA9ICQoXCI8bGk+PC9saT5cIikudGV4dChtZXNzYWdlc1tpXSk7XG5cdFx0XHR0ZXh0Q29sb3IgPyBsaXN0RWxlbWVudC5jc3MoJ2NvbG9yJywgdGV4dENvbG9yKSA6IG51bGw7XG5cdFx0XHR3YXJuaW5nTGlzdC5hcHBlbmQobGlzdEVsZW1lbnQpXG5cdFx0fVxuXHRcdFxuXHRcdCQoaW5wdXRFbGVtZW50KS5hZnRlcih3YXJuaW5nTGlzdClcblx0fVxuXG5cdGZ1bmN0aW9uIGlzVmFsaWQoZm9ybUVsZW1lbnQpIHtcblx0XHRjb25zdCBmb3JtID0gZm9ybUVsZW1lbnQgaW5zdGFuY2VvZiBqUXVlcnkgPyBmb3JtRWxlbWVudFswXSA6IGZvcm1FbGVtZW50O1xuXHRcdGNvbnN0IGlucHV0cyA9IGZvcm0ucXVlcnlTZWxlY3RvckFsbCgnW2RhdGEtdmFsaWRhdGVdJyk7XG5cdFx0bGV0IGVycm9yc0NvdW50ZXIgPSAwO1xuXG5cdFx0Zm9yIChsZXQgaSA9IDA7IGkgPCBpbnB1dHMubGVuZ3RoOyBpKyspIHtcblx0XHRcdGxldCBlcnJvck1lc3NhZ2VzID0gW107XG5cdFx0XHRsZXQgdGV4dENvbG9yID0gaW5wdXRzW2ldLmRhdGFzZXQudGV4dENvbG9yO1xuXG5cdFx0XHQkKGlucHV0c1tpXSkucmVtb3ZlQ2xhc3MoXCJqc19jb250YWluc0Vycm9yXCIpO1xuXHRcdFx0JChpbnB1dHNbaV0pLm5leHQoJy5qc193YXJuaW5nLWxpc3QnKS5yZW1vdmUoKTtcblxuXHRcdFx0bGV0IHZhbGlkYXRpb25zQXJyYXkgPSBbXTtcblx0XHRcdGxldCBpbnB1dERhdGEgPSBpbnB1dHNbaV0uZGF0YXNldC52YWxpZGF0ZSA/IGlucHV0c1tpXS5kYXRhc2V0LnZhbGlkYXRlLnNwbGl0KCcgJykgOiBmYWxzZTtcblxuXHRcdFx0Ly8gLS0tLS0tLS0tXG5cdFx0XHRpbnB1dHNbaV0udmFsdWUgPSBpbnB1dHNbaV0udmFsdWUudHJpbSgpO1xuXHRcdFx0Ly8gLS0tLS0tLS0tXG5cblx0XHRcdHZhbGlkYXRpb25zQXJyYXkgPSBpbnB1dERhdGEgPyBpbnB1dERhdGEgOiBudWxsO1xuXHRcdFx0Ly8gaW5wdXRzW2ldLnJlcXVpcmVkID8gdmFsaWRhdGlvbnNBcnJheS5wdXNoKCdyZXF1aXJlZCcpIDogbnVsbDtcblx0XHRcdFxuXHRcdFx0aWYgKHZhbGlkYXRpb25zQXJyYXkubGVuZ3RoKSB7XG5cdFx0XHRcdGxldCB2YWxpZGF0aW9uUmVzdWx0ID0gdmFsaWRhdGUoaW5wdXRzW2ldLCB2YWxpZGF0aW9uc0FycmF5KTtcblx0XHRcdFx0dmFsaWRhdGlvblJlc3VsdCA/IGVycm9yTWVzc2FnZXMgPSB2YWxpZGF0aW9uUmVzdWx0IDogbnVsbDtcblx0XHRcdH1cblxuXHRcdFx0aWYgKGVycm9yTWVzc2FnZXMubGVuZ3RoKSB7IFxuXHRcdFx0XHRzaG93V2FybmluZyhpbnB1dHNbaV0sIGVycm9yTWVzc2FnZXMsIHRleHRDb2xvcik7XG5cdFx0XHRcdGVycm9yc0NvdW50ZXIrKztcblx0XHRcdH1cblx0XHR9XG5cblx0XHRyZXR1cm4gZXJyb3JzQ291bnRlciA+IDAgPyBmYWxzZSA6IHRydWU7XG5cdH1cblxuXHQvLyAtLS0tLS0tLS0tLS0tLS1cblx0cmV0dXJuIHtcblx0XHRpc1ZhbGlkOiBpc1ZhbGlkLFxuXHR9XG59KSgpXG5cbi8vIC0tLS0tLS0tLVZhbGlkYXRpb24gU2NyaXB0IFRlc3QtLS0tLS0tLS0tLS0tXG5cbi8vICQoJ2JvZHknKS5vbignY2xpY2snLCAnYnV0dG9uW3R5cGU9XCJzdWJtaXRcIl0nLCBmdW5jdGlvbihlKSB7XG4vLyBcdC8vIGNvbnNvbGUubG9nKCdvaycpXG4vLyBcdGUucHJldmVudERlZmF1bHQoKTtcblxuLy8gXHQvLyBWYWxpZGF0aW9uTW9kdWxlLmlzVmFsaWQodGhpcy5mb3JtKVxuLy8gXHRpZiggIVZhbGlkYXRpb25Nb2R1bGUuaXNWYWxpZCh0aGlzLmZvcm0pICkge1xuLy8gXHRcdGNvbnNvbGUubG9nKCdmb3JtIG5vdCB2YWxpZDogJywgdGhpcy5mb3JtKVxuLy8gXHR9IGVsc2Uge1xuLy8gXHRcdGNvbnNvbGUubG9nKCdmb3JtIHZhbGlkOiAnLCB0aGlzLmZvcm0pXG4vLyBcdH1cbi8vIH0pKi9cblx0LypnbG9iLkFuaW1hdGVCb3JkZXIgPSBmdW5jdGlvbiAoYW5pbWF0ZWRCbG9ja3MsIG9wdGlvbnNPYmopIHtcblxuXHR2YXIgYW5pbWF0ZWREYXNoQmxvY2tzID0gYW5pbWF0ZWRCbG9ja3M7XG5cdHZhciBvcHRpb25zID0gb3B0aW9uc09iajtcblxuXHQvLyBjb25zb2xlLmxvZyhvcHRpb25zLnNoYWRlZFNlY3Rpb24pO1xuXHQvLyAtLS0tLS0tLS0tIE1ldGhvZHMgLS0tLS0tLS1cblxuXHRmdW5jdGlvbiBnZXRUb3RhbExlbmd0aChwYXJlbnRCbG9jaywgcmVjdCkge1xuXHRcdC8vIHZhciByYWRpdXMgPSArcmVjdC5nZXRBdHRyaWJ1dGUoJ3J4Jyk7XG5cdFx0dmFyIGxlbmd0aCA9IDA7XG5cdFx0dmFyIHJlY3RXaWR0aCA9IHBhcmVudEJsb2NrLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLndpZHRoIC0gKG9wdGlvbnMuYm9yZGVyV2lkdGggKiAyKTtcblx0XHR2YXIgcmVjdEhlaWdodCA9IHBhcmVudEJsb2NrLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLmhlaWdodCAtIChvcHRpb25zLmJvcmRlcldpZHRoICogMik7XG5cdFx0dmFyIHJhZGl1cyA9IG9wdGlvbnMucmFkaXVzID8gcmVjdEhlaWdodCAvIDIgOiBudWxsO1xuXHRcdC8vIGNvbnNvbGUubG9nKHBhcmVudEJsb2NrLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLndpZHRoKVxuXHRcdGlmIChyYWRpdXMpIHtcblx0XHRcdHJldHVybiB7XG5cdFx0XHRcdGxlbmd0aDogKyggKHJlY3RXaWR0aCAtIHJhZGl1cyoyKSAqIDIgKSArICggMiozLjE0ICogcmFkaXVzICksXG5cdFx0XHRcdHJhZGl1czogcmFkaXVzXG5cdFx0XHR9IFxuXHRcdH0gZWxzZSB7XG5cdFx0XHRyZXR1cm4ge1xuXHRcdFx0XHRsZW5ndGg6ICsoIHJlY3RXaWR0aCArIHJlY3RIZWlnaHQgKSAqIDJcblx0XHRcdH1cblx0XHR9XG5cdH1cblxuXHRmdW5jdGlvbiBnZXREYXNoQXJyYXlTdHJpbmcocmVjdCwgcmVjdExlbmd0aCkge1xuXHRcdHZhciBkYXNoVG90YWxMZW5ndGggPSBvcHRpb25zLnNoYWRlZFNlY3Rpb24gKyBvcHRpb25zLnRyYW5zcGFyZW50U2VjdGlvbjtcblxuXHRcdHZhciBkYXNoUXVhbnRpdHkgPSBNYXRoLnJvdW5kKCByZWN0TGVuZ3RoIC8gZGFzaFRvdGFsTGVuZ3RoIClcblx0XHR2YXIgZGlmZmVyZW5jZSA9ICggZGFzaFRvdGFsTGVuZ3RoKmRhc2hRdWFudGl0eSAtIHJlY3RMZW5ndGggKSAvIGRhc2hRdWFudGl0eTtcblx0XHRcblx0XHRkaWZmZXJlbmNlID0gKCBNYXRoLnJvdW5kKGRpZmZlcmVuY2UgKiAxMCkgLyAxMCApIC8gMjtcblxuXHRcdG9wdGlvbnMubmV3U2hhZGVkU2VjdGlvbiA9IG9wdGlvbnMuc2hhZGVkU2VjdGlvbiAtIGRpZmZlcmVuY2U7XG5cdFx0b3B0aW9ucy5uZXdUcmFuc3BhcmVudFNlY3Rpb24gPSBvcHRpb25zLnRyYW5zcGFyZW50U2VjdGlvbiAtIGRpZmZlcmVuY2U7XG5cblx0XHRyZXR1cm4gb3B0aW9ucy5uZXdTaGFkZWRTZWN0aW9uICsgJyAnICsgb3B0aW9ucy5uZXdUcmFuc3BhcmVudFNlY3Rpb247XG5cdH1cblxuXHRmdW5jdGlvbiBjeWNsZU9mZnNldChldmVudCwgYW5pbWF0ZWRCbG9jaywgZGFzaEFycmF5U3VtTnVtYmVyKSB7XG5cdCAgaWYgKCBldmVudC5wcm9wZXJ0eU5hbWUgPT0gJ3N0cm9rZS1kYXNob2Zmc2V0JyApIHtcblx0ICBcdC8vIGNvbnNvbGUubG9nKCdzdHJva2UtZGFzaG9mZnNldCcpXG5cdCAgXHRhbmltYXRlZEJsb2NrLmNsYXNzTGlzdC5hZGQoJ2pzX3Jlc2V0VHJhbnNpdGlvbicpO1xuXHQgIFx0YW5pbWF0ZWRCbG9jay5zZXRBdHRyaWJ1dGUoJ3N0cm9rZS1kYXNob2Zmc2V0JywgMCk7XG5cdCAgXHRcblx0ICBcdHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG5cdCAgXHRcdGFuaW1hdGVkQmxvY2suY2xhc3NMaXN0LnJlbW92ZSgnanNfcmVzZXRUcmFuc2l0aW9uJyk7XG5cdCAgXHRcdGFuaW1hdGVkQmxvY2suc2V0QXR0cmlidXRlKCdzdHJva2UtZGFzaG9mZnNldCcsIGRhc2hBcnJheVN1bU51bWJlcilcdFx0XHRcblx0ICBcdH0sIDEwKVxuXHQgIH1cblx0fVxuXG5cdHZhciBldmVudEhhbmRsZXIgPSBmdW5jdGlvbihldmVudCkge1xuXHRcdC8vIGNvbnNvbGUubG9nKCdldmVudDogJylcblx0XHRldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcblx0XHRjeWNsZU9mZnNldChldmVudCwgdGhpcywgdGhpcy5kYXRhc2V0LmRhc2hBcnJheVN1bSlcblx0fVxuXG5cdC8vIC0tLS0tLS0tLS0gQWN0aW9uIC0tLS0tLS0tXG5cblx0aWYgKGFuaW1hdGVkRGFzaEJsb2Nrcy5sZW5ndGgpIHtcblxuXHRcdHZhciBpbml0ID0gZnVuY3Rpb24oKSB7XG5cdFx0XHRmb3IgKHZhciBpID0gMDsgaSA8IGFuaW1hdGVkRGFzaEJsb2Nrcy5sZW5ndGg7IGkrKykge1xuXHRcdFx0XHR2YXIgcmVjdCA9IGFuaW1hdGVkRGFzaEJsb2Nrc1tpXS5xdWVyeVNlbGVjdG9yKCdyZWN0LmFuaW1hdGVkQmxvY2snKTtcblx0XHRcdFx0dmFyIHRvdGFsTGVuZ3RoID0gMCwgcmVzdWx0RGFzaEFycmF5U3RyaW5nID0gJycsIGRhc2hBcnJheVN1bSA9IDAsIHJhZGl1cyA9IDA7XG5cdFx0XHRcdFxuXHRcdFx0XHRyZWN0LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJ0cmFuc2l0aW9uZW5kXCIsIGV2ZW50SGFuZGxlcik7XG5cblx0XHRcdFx0dG90YWxMZW5ndGggPSBnZXRUb3RhbExlbmd0aCggYW5pbWF0ZWREYXNoQmxvY2tzW2ldLCByZWN0ICk7XG5cdFx0XHRcdHJhZGl1cyA9IHRvdGFsTGVuZ3RoLnJhZGl1cztcblx0XHRcdFx0Ly8gY29uc29sZS5sb2codG90YWxMZW5ndGgubGVuZ3RoKVxuXHRcdFx0XHRyZXN1bHREYXNoQXJyYXlTdHJpbmcgPSBnZXREYXNoQXJyYXlTdHJpbmcocmVjdCwgdG90YWxMZW5ndGgubGVuZ3RoKTtcblx0XHRcdFx0ZGFzaEFycmF5U3VtID0gTWF0aC5yb3VuZCggb3B0aW9ucy5uZXdTaGFkZWRTZWN0aW9uICsgb3B0aW9ucy5uZXdUcmFuc3BhcmVudFNlY3Rpb24gKTtcblx0XHRcdFx0ZGFzaEFycmF5U3VtID0gb3B0aW9ucy5yZXZlcnNlID8gZGFzaEFycmF5U3VtIDogZGFzaEFycmF5U3VtICogLTE7XG5cblx0XHRcdFx0cmVjdC5zZXRBdHRyaWJ1dGUoJ3N0cm9rZS13aWR0aCcsIG9wdGlvbnMuYm9yZGVyV2lkdGgpO1xuXHRcdFx0XHRyYWRpdXMgPyByZWN0LnNldEF0dHJpYnV0ZSgncngnLCByYWRpdXMpIDogbnVsbDtcblx0XHRcdFx0cmVjdC5zZXRBdHRyaWJ1dGUoJ3N0cm9rZS1kYXNoYXJyYXknLCByZXN1bHREYXNoQXJyYXlTdHJpbmcpO1xuXHRcdFx0XHRyZWN0LnNldEF0dHJpYnV0ZSgnc3Ryb2tlLWRhc2hvZmZzZXQnLCBkYXNoQXJyYXlTdW0qMik7XG5cdFx0XHRcdHJlY3Quc2V0QXR0cmlidXRlKCdkYXRhLWRhc2hBcnJheVN1bScsIGRhc2hBcnJheVN1bSoyKTtcblxuXHRcdFx0XHRyZWN0LmFkZEV2ZW50TGlzdGVuZXIoXCJ0cmFuc2l0aW9uZW5kXCIsIGV2ZW50SGFuZGxlcik7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0aW5pdCgpO1xuXG5cdFx0Ly8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG5cdFx0dmFyIHRpbWVyID0gbnVsbDtcblx0XHR3aW5kb3cub25yZXNpemUgPSBmdW5jdGlvbihldmVudCkge1xuXHRcdCAgaWYgKHRpbWVyKSB7IGNsZWFyVGltZW91dCh0aW1lcik7IH1cblxuXHRcdCAgdGltZXIgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuXHRcdCAgICB0aW1lciA9IG51bGw7XG5cblx0XHQgICAgLy8geW91ciBldmVudCBoYW5kbGluZyBsb2dpYyBoZXJlXG5cdFx0ICAgIC8vIGNvbnNvbGUubG9nKCdyZXNpemUnKVxuXHRcdCAgICBpbml0KClcblxuXHRcdCAgfSwgNTApO1xuXHRcdH07XG5cblx0fVxuXG59XG5cbiovXG4gIC8qLy8galF1ZXJ5KCc8ZGl2IGNsYXNzPVwicXVhbnRpdHktbmF2XCI+PGRpdiBjbGFzcz1cInF1YW50aXR5LWJ1dHRvbiBxdWFudGl0eS11cFwiPjwvZGl2PjxkaXYgY2xhc3M9XCJxdWFudGl0eS1idXR0b24gcXVhbnRpdHktZG93blwiPjwvZGl2PjwvZGl2PicpLmluc2VydEFmdGVyKCcucXVhbnRpdHkgaW5wdXQnKTtcbmpRdWVyeSgnLmN1c3RvbS1xdWFudGl0eScpLmVhY2goZnVuY3Rpb24oKSB7XG4gIHZhciBzcGlubmVyID0galF1ZXJ5KHRoaXMpLFxuICBpbnB1dCA9IHNwaW5uZXIuZmluZCgnaW5wdXRbdHlwZT1cIm51bWJlclwiXScpLFxuICBidG5VcCA9IHNwaW5uZXIuZmluZCgnLnF1YW50aXR5LXVwJyksXG4gIGJ0bkRvd24gPSBzcGlubmVyLmZpbmQoJy5xdWFudGl0eS1kb3duJyksXG4gIG1pbiA9IGlucHV0LmF0dHIoJ21pbicpLFxuICBtYXggPSBpbnB1dC5hdHRyKCdtYXgnKTtcblxuICBidG5VcC5jbGljayhmdW5jdGlvbigpIHtcblxuICAgIHZhciBvbGRWYWx1ZSA9IHBhcnNlRmxvYXQoaW5wdXQudmFsKCkpO1xuICAgIGlmIChvbGRWYWx1ZSA+PSBtYXgpIHtcbiAgICAgICAgdmFyIG5ld1ZhbCA9IG9sZFZhbHVlO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHZhciBuZXdWYWwgPSBvbGRWYWx1ZSArIDE7XG4gICAgfVxuXG4gICAgc3Bpbm5lci5maW5kKFwiaW5wdXRcIikudmFsKG5ld1ZhbCk7XG5cbiAgICBzcGlubmVyLmZpbmQoXCJpbnB1dFwiKS50cmlnZ2VyKFwiY2hhbmdlXCIpO1xuXG4gIH0pO1xuXG4gIGJ0bkRvd24uY2xpY2soZnVuY3Rpb24oKSB7XG5cbiAgICB2YXIgb2xkVmFsdWUgPSBwYXJzZUZsb2F0KGlucHV0LnZhbCgpKTtcbiAgICBpZiAob2xkVmFsdWUgPD0gbWluKSB7XG4gICAgICAgIHZhciBuZXdWYWwgPSBvbGRWYWx1ZTtcbiAgICB9IGVsc2Uge1xuICAgICAgICB2YXIgbmV3VmFsID0gb2xkVmFsdWUgLSAxO1xuICAgIH1cbiAgICBzcGlubmVyLmZpbmQoXCJpbnB1dFwiKS52YWwobmV3VmFsKTtcbiAgICBzcGlubmVyLmZpbmQoXCJpbnB1dFwiKS50cmlnZ2VyKFwiY2hhbmdlXCIpO1xuICB9KTtcblxufSk7Ki9cbiAgLypnbG9iLkFjY29yZGlvbk1vZHVsZSAgPSAoZnVuY3Rpb24oKSB7XG5cdC8vIGNvbnNvbGUubG9nKCdBY2NvcmRpb25Nb2R1bGUgb2snKTtcblx0XG5cdGZ1bmN0aW9uIHRvZ2dsZUNvbnRlbnQob3B0aW9ucywgYnV0dG9uLCB0YXJnZXRCbG9jaywgYWxsVGFyZ2V0QmxvY2tzKSB7XG5cdFx0bGV0IHN1Yk1lbnVQYXJlbnRzID0gYnV0dG9uID8gZmluZEFsbFBhcmVudHMoYnV0dG9uLCAnc3VibWVudVdyYXBwZXInKSA6IG51bGw7XG5cdFx0bGV0IHRhcmdldEhlaWdodCA9IHRhcmdldEJsb2NrID8gdGFyZ2V0QmxvY2suZmlyc3RFbGVtZW50Q2hpbGQub2Zmc2V0SGVpZ2h0IDogbnVsbDtcblxuXHRcdC8vIGNvbnNvbGUubG9nKHN1Yk1lbnVQYXJlbnRzKVxuXG5cdFx0ZnVuY3Rpb24gZmluZEFsbFBhcmVudHMoZWxlbWVudCwgc2VhcmNoQ2xhc3MpIHtcblx0XHRcdHZhciBmaW5kZWQgPSBmYWxzZTtcblx0XHRcdHZhciBjdXJyZW50RWxlbWVudCA9IGVsZW1lbnQsIGZpbmRpbmdFbGVtZW50cyA9IFtdO1xuXHRcdFx0dHJ5IHtcblx0XHRcdFx0d2hpbGUoIWZpbmRlZCkge1xuXHRcdFx0XHQvLyBjb25zb2xlLmxvZyhjdXJyZW50RWxlbWVudC5wYXJlbnRFbGVtZW50KVxuXHRcdFx0XHRcdHZhciBwYXJlbnQgPSBjdXJyZW50RWxlbWVudC5wYXJlbnRFbGVtZW50O1xuXG5cdFx0XHRcdFx0aWYgKCBwYXJlbnQuY2xhc3NMaXN0LmNvbnRhaW5zKHNlYXJjaENsYXNzKSApIHtcblx0XHRcdFx0XHRcdGZpbmRpbmdFbGVtZW50cy5wdXNoKHBhcmVudCk7XG5cdFx0XHRcdFx0fSBlbHNlIGlmIChwYXJlbnQuY2xhc3NMaXN0LmNvbnRhaW5zKCdtYWluU3VibWVudVdyYXBwZXInKSkge1xuXHRcdFx0XHRcdFx0ZmluZGVkID0gdHJ1ZTtcblx0XHRcdFx0XHRcdGZpbmRpbmdFbGVtZW50cy5wdXNoKGN1cnJlbnRFbGVtZW50LnBhcmVudEVsZW1lbnQpO1xuXHRcdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdFx0fSBlbHNlIGlmIChwYXJlbnQuY2xhc3NMaXN0LmNvbnRhaW5zKCdhY2NvcmRpb25NZW51JykpIGJyZWFrO1xuXHRcdFx0XHRcdGN1cnJlbnRFbGVtZW50ID0gcGFyZW50O1xuXHRcdFx0XHR9XHRcdFx0XHRcblx0XHRcdH0gY2F0Y2goZXJyb3IpIHtjb25zb2xlLmxvZyhlcnJvcil9XG5cblx0XHRcdC8vIGNvbnNvbGUubG9nKGN1cnJlbnRFbGVtZW50KVxuXHRcdFx0cmV0dXJuIGZpbmRpbmdFbGVtZW50cztcblx0XHR9XG5cblx0XHRmdW5jdGlvbiByZXNldERyb3BEb3duKHRhcmdldEVsZW1lbnRzKSB7XG5cdFx0XHRmb3IgKGxldCBpID0gMDsgaSA8IHRhcmdldEVsZW1lbnRzLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRcdHRhcmdldEVsZW1lbnRzW2ldLnBhcmVudEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSgnYWN0aXZlJyk7XG5cdFx0XHRcdHRhcmdldEVsZW1lbnRzW2ldLnN0eWxlLmhlaWdodCA9IFwiXCI7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0ZnVuY3Rpb24gY2xvc2VTaWJsaW5ncyhidXR0b24sIHRhcmdldEVsZW1lbnRzKSB7XG5cdFx0XHRmb3IgKGxldCBpID0gMDsgaSA8IHRhcmdldEVsZW1lbnRzLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRcdGxldCBidXR0b24gPSB0YXJnZXRFbGVtZW50c1tpXS5wYXJlbnRFbGVtZW50XG5cdFx0XHRcdGlmIChidXR0b24uY2xhc3NMaXN0LmNvbnRhaW5zKCdhY3RpdmUnKSApIHtcblx0XHRcdFx0XHRidXR0b24uY2xhc3NMaXN0LnJlbW92ZSgnYWN0aXZlJyk7XG5cdFx0XHRcdFx0dGFyZ2V0RWxlbWVudHNbaV0uc3R5bGUuaGVpZ2h0ID0gXCIwcHhcIjtcblx0XHRcdFx0fVxuXHRcdFx0XHRcblx0XHRcdH1cblx0XHR9XG5cblx0XHRmdW5jdGlvbiBkcm9wRG93bihidXR0b24sIHRhcmdldEVsZW1lbnQsIHN1Yk1lbnVQYXJlbnRzKSB7XG5cdFx0XHRpZiAoIGJ1dHRvbi5jaGVja2VkIHx8IGJ1dHRvbi5jbGFzc0xpc3QuY29udGFpbnMoJ2FjdGl2ZScpICkge1xuXHRcdFx0XHRpZiAoc3ViTWVudVBhcmVudHMubGVuZ3RoKSB7XG5cdFx0XHRcdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCBzdWJNZW51UGFyZW50cy5sZW5ndGg7IGkrKykge1xuXHRcdFx0XHRcdFx0c3ViTWVudVBhcmVudHNbaV0uc3R5bGUuaGVpZ2h0ID0gc3ViTWVudVBhcmVudHNbaV0ub2Zmc2V0SGVpZ2h0ICsgdGFyZ2V0SGVpZ2h0ICsgJ3B4Jztcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdFx0dGFyZ2V0RWxlbWVudC5zdHlsZS5oZWlnaHQgPSB0YXJnZXRIZWlnaHQgKyAncHgnXG5cdFx0XHR9IGVsc2Uge1x0XHRcdCBcblx0XHRcdFx0dGFyZ2V0RWxlbWVudC5zdHlsZS5oZWlnaHQgPSBcIjBweFwiO1xuXHRcdFx0XHRmb3IgKHZhciBpID0gMDsgaSA8IHN1Yk1lbnVQYXJlbnRzLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRcdFx0c3ViTWVudVBhcmVudHNbaV0uc3R5bGUuaGVpZ2h0ID0gIHN1Yk1lbnVQYXJlbnRzW2ldLm9mZnNldEhlaWdodCAtIHRhcmdldEhlaWdodCArICdweCc7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cblxuXHRcdHN3aXRjaCAob3B0aW9ucyAgfHwgJ2RlZmF1bHQnKSB7XG5cblx0XHRcdGNhc2UgJ3dpdGhTaWJsaW5ncyc6IFxuXHRcdFx0XHRjbG9zZVNpYmxpbmdzKGJ1dHRvbiwgYWxsVGFyZ2V0QmxvY2tzKTtcblx0XHRcdFx0ZHJvcERvd24oYnV0dG9uLCB0YXJnZXRCbG9jaywgc3ViTWVudVBhcmVudHMpO1xuXHRcdFx0YnJlYWs7XG5cblx0XHRcdGNhc2UgJ3dpdGhvdXRTaWJsaW5ncyc6IGRyb3BEb3duKGJ1dHRvbiwgdGFyZ2V0QmxvY2ssIHN1Yk1lbnVQYXJlbnRzKTsgYnJlYWs7XG5cblx0XHRcdGNhc2UgJ3Jlc2V0RHJvcERvd24nOiByZXNldERyb3BEb3duKGFsbFRhcmdldEJsb2Nrcyk7IGJyZWFrO1xuXG5cdFx0XHRkZWZhdWx0OiBjb25zb2xlLmVycm9yKCdubyBjb3JyZWN0IG9wdGlvbiB0eXBlZCBpbiB0b2dnbGVDb250ZW50IGZ1bmN0aW9uJyk7XG5cblx0XHR9XG5cblx0fVxuICAgIFxuXHQvLyAtLS0tLVJlc2l6ZSBFdmVudC0tLS0tLVxuXHQvLyBjb25zdCBtb2JpbGVGaWx0ZXJNZW51QmxvY2tzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnI2ZpbHRlcldyYXBwZXIgLmZpbHRlci1pdGVtIC5maWx0ZXItY29udGVudC13cmFwcGVyJyk7XG5cblx0Ly8gbGV0IHRpbWVyID0gbnVsbDtcblxuXHQvLyB3aW5kb3cub25yZXNpemUgPSBmdW5jdGlvbiAoKSB7XG5cdC8vIFx0aWYgKHRpbWVyKSB7XG5cdC8vIFx0XHRjbGVhclRpbWVvdXQodGltZXIpO1xuXHQvLyBcdH1cblxuXHQvLyBcdHRpbWVyID0gc2V0VGltZW91dChmdW5jdGlvbigpIHtcblx0Ly8gXHRcdHRpbWVyID0gbnVsbDtcblxuIC8vICAgICAvLyA9PT09PT09SGFuZGxlcnM9PT09PT09XG4gLy8gICAgICBpZiAobW9iaWxlRmlsdGVyTWVudUJsb2Nrcykge1xuIC8vICAgICAgXHRpZiAoZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsaWVudFdpZHRoID4gOTkxKSB7XG5cdC8vIFx0XHRcdFx0dG9nZ2xlQ29udGVudChcInJlc2V0RHJvcERvd25cIiwgbnVsbCwgbnVsbCwgbW9iaWxlRmlsdGVyTWVudUJsb2Nrcyk7XG5cdC8vIFx0XHRcdH1cbiAvLyAgICAgIH1cbiAvLyAgICAgfSwgNTApO1xuXHQvLyB9O1xuXG5cdFxuLy8gLS0tLS0tLS0tLS0tXG5cblx0cmV0dXJuIHtcblx0XHR0b2dnbGVDb250ZW50OiB0b2dnbGVDb250ZW50LFxuXHR9XG5cbn0pKCkqL1xuICAvKmdsb2IuVG9nZ2xlQ29udGVudE1vZHVsZSAgPSAoZnVuY3Rpb24oKSB7XG5cdC8vIGNvbnNvbGUubG9nKCdUb2dnbGVDb250ZW50TW9kdWxlIG9rJyk7XG5cdC8vIGNvbnNvbGUudGltZSgnVG9nZ2xlQ29udGVudCBNb2R1bGUgbG9hZCcpO1xuXG5cdGZ1bmN0aW9uIHRvZ2dsZUNvbnRlbnQoYnV0dG9uRWxlbWVudCwgZGF0YSkge1xuXHRcdGxldCBidXR0b24gPSBidXR0b25FbGVtZW50LFxuXHRcdFx0XHRidXR0b25EYXRhID0gZGF0YS5idXR0b25EYXRhLFxuXHRcdFx0XHR0YXJnZXRzID0gZGF0YS50YXJnZXRzLFxuXHRcdFx0XHR0aGlzVGFyZ2V0ID0gZGF0YS50aGlzQ29udGVudCxcblx0XHRcdFx0dGFyZ2V0QnV0dG9ucyA9IGRhdGEudGFyZ2V0QnV0dG9ucyxcblx0XHRcdFx0dGFyZ2V0c1JldmVyc2UgPSBkYXRhLnRhcmdldHNSZXZlcnNlO1xuXG5cdFx0XHQvLyBjb25zb2xlLmxvZyhkYXRhKVxuXG5cdFx0XG5cdFx0Ly8gLS0tLS0tTWV0aG9kcy0tLS0tLS0tXG5cblx0XHRmdW5jdGlvbiBkcm9wRG93bihidXR0b24sIHRhcmdldEJsb2NrLCBhY3Rpb24sIGJ1dHRvbnNFbGVtZW50cykge1xuXHRcdFx0aWYgKGFjdGlvbiA9PT0gJ3Nob3cnICkge1xuXHRcdFx0XHRidXR0b24uY2hlY2tlZCB8fCBidXR0b24uY2xhc3NMaXN0LmNvbnRhaW5zKCdhY3RpdmUnKSA/IFxuXHRcdFx0XHR0YXJnZXRCbG9jay5zdHlsZS5oZWlnaHQgPSB0YXJnZXRCbG9jay5maXJzdEVsZW1lbnRDaGlsZC5vZmZzZXRIZWlnaHQgKyAncHgnIDpcblx0XHRcdFx0dGFyZ2V0QmxvY2suc3R5bGUuaGVpZ2h0ID0gXCIwcHhcIjtcblx0XHRcdH1cdGVsc2UgaWYgKGFjdGlvbiA9PT0gJ2hpZGVSZXZlcnNlJykge1xuXHRcdFx0XHRidXR0b24uY2hlY2tlZCB8fCBidXR0b24uY2xhc3NMaXN0LmNvbnRhaW5zKCdhY3RpdmUnKSA/IFxuXHRcdFx0XHR0YXJnZXRCbG9jay5zdHlsZS5oZWlnaHQgPSBcIjBweFwiIDpcblx0XHRcdFx0dGFyZ2V0QmxvY2suc3R5bGUuaGVpZ2h0ID0gdGFyZ2V0QmxvY2suZmlyc3RFbGVtZW50Q2hpbGQub2Zmc2V0SGVpZ2h0ICsgJ3B4Jztcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHRhcmdldEJsb2NrLnN0eWxlLmhlaWdodCA9IFwiMHB4XCI7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0ZnVuY3Rpb24gc2hvd0hpZGUoYnV0dG9uLCB0YXJnZXRCbG9jaywgYWN0aW9uLCBjc3NTaG93Q2xhc3MsIGNzc0hpZGVDbGFzcykge1xuXHRcdFx0aWYgKGFjdGlvbiA9PT0gJ3Nob3cnICkge1xuXHRcdFx0XHRidXR0b24uY2hlY2tlZCB8fCBidXR0b24uY2xhc3NMaXN0LmNvbnRhaW5zKCdhY3RpdmUnKSA/IFxuXHRcdFx0XHRcdHRhcmdldEJsb2NrLmNsYXNzTGlzdC5hZGQoY3NzU2hvd0NsYXNzKSA6IHRhcmdldEJsb2NrLmNsYXNzTGlzdC5yZW1vdmUoY3NzU2hvd0NsYXNzKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGJ1dHRvbi5jaGVja2VkIHx8IGJ1dHRvbi5jbGFzc0xpc3QuY29udGFpbnMoJ2FjdGl2ZScpID9cblx0XHRcdFx0XHR0YXJnZXRCbG9jay5jbGFzc0xpc3QuYWRkKGNzc0hpZGVDbGFzcykgOiB0YXJnZXRCbG9jay5jbGFzc0xpc3QucmVtb3ZlKGNzc0hpZGVDbGFzcyk7XG5cdFx0XHR9XHRcblx0XHR9XG5cblx0XHQvLyAtLS0tLS0tLS0tLS0tLS0tLS0tXG5cblx0XHRmdW5jdGlvbiBjbGVhbkJ1dHRvbnModGFyZ2V0RWxlbWVudHMpIHtcblx0XHRcdGZvciAobGV0IGkgPSAwOyBpIDwgdGFyZ2V0RWxlbWVudHMubGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0dGFyZ2V0RWxlbWVudHNbaV0uY2xhc3NMaXN0LmNvbnRhaW5zKCdhY3RpdmUnKSA/IFxuXHRcdFx0XHRcdHRhcmdldEVsZW1lbnRzW2ldLmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpIDogbnVsbDtcblx0XHRcdH1cblx0XHR9XG5cblx0XHRmdW5jdGlvbiB0b2dnbGUodGFyZ2V0QmxvY2tzLCBhY3Rpb24pIHtcblx0XHRcdC8vIGNvbnNvbGUubG9nKHRhcmdldEJsb2Nrcylcblx0XHRcdGZvciAobGV0IGkgPSAwOyBpIDwgdGFyZ2V0QmxvY2tzLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRcdHN3aXRjaCAoYnV0dG9uRGF0YS5tZW51VHlwZSB8fCAnZGVmYXVsdCcpIHtcblx0XHRcdFx0XHRjYXNlICdzY2FsZSc6IHNob3dIaWRlKCBidXR0b24sIHRhcmdldEJsb2Nrc1tpXSwgYWN0aW9uLCAnanNfc2hvd1NjYWxlJywgJ2pzX2hpZGVTY2FsZScgKTsgYnJlYWs7XG5cdFx0XHRcdFx0Y2FzZSAnZHJvcC1kb3duJzogZHJvcERvd24oIGJ1dHRvbiwgdGFyZ2V0QmxvY2tzW2ldLCBhY3Rpb24gKTsgYnJlYWs7XG5cdFx0XHRcdFx0Y2FzZSAnZHJvcC1sZWZ0Jzogc2hvd0hpZGUoIGJ1dHRvbiwgdGFyZ2V0QmxvY2tzW2ldLCBhY3Rpb24sICdqc19zaG93U2xpZGVfbGVmdCcsICdqc19oaWRlU2xpZGVfbGVmdCcpOyBicmVhaztcblx0XHRcdFx0XHRjYXNlICdkcm9wLXJpZ2h0Jzogc2hvd0hpZGUoIGJ1dHRvbiwgdGFyZ2V0QmxvY2tzW2ldLCBhY3Rpb24sICdqc19zaG93U2xpZGVfcmlnaHQnLCAnanNfaGlkZVNsaWRlX3JpZ2h0Jyk7IGJyZWFrO1xuXHRcdFx0XHRcdGNhc2UgJ3Nob3ctaGlkZSc6IHNob3dIaWRlKCBidXR0b24sIHRhcmdldEJsb2Nrc1tpXSwgYWN0aW9uLCAnanNfc2hvdycsICdqc19oaWRlJyApOyBicmVhaztcblxuXHRcdFx0XHRcdGRlZmF1bHQ6IGNvbnNvbGUuZXJyb3IoJ25vIGNvcnJlY3QgXCJkYXRhLW1lbnUtdHlwZVwiIGF0dHJpYnV0ZSBpcyBzZXQgdG8gdGhlIGJ1dHRvbiBlbGVtZW50IGluIEhUTUwhJyk7XG5cdFx0XHRcdH1cdFx0XHRcdFx0XHRcblx0XHRcdH0gICAgICBcblx0XHR9XG5cblxuXHRcdHN3aXRjaCAoYnV0dG9uRGF0YS5idXR0b25UeXBlIHx8ICdkZWZhdWx0Jykge1xuXHRcdFx0Y2FzZSAnY2hlY2tib3gnOlxuXHRcdFx0Y2FzZSAnYnV0dG9uJzpcblx0XHRcdGNhc2UgJ21lbnVCdXR0b24nOlxuXHRcdFx0XHRcdHRvZ2dsZSh0YXJnZXRzLCAnc2hvdycpO1xuXHRcdFx0XHRcdHRvZ2dsZSh0YXJnZXRzUmV2ZXJzZSwgJ2hpZGVSZXZlcnNlJyk7XHRcdFx0XHRcdFxuXHRcdFx0YnJlYWs7XG5cblx0XHRcdGNhc2UgJ2FjY29yZGlvbic6IFxuXHRcdFx0XHRpZiAoYnV0dG9uRGF0YS5zaWJsaW5ncyA9PSAneWVzJykge1xuXHRcdFx0XHRcdHRvZ2dsZSh0YXJnZXRzUmV2ZXJzZSwgJ2hpZGUnKTtcblx0XHRcdFx0XHRjbGVhbkJ1dHRvbnModGFyZ2V0QnV0dG9ucyk7XG5cdFx0XHRcdH1cblx0XHRcdFx0dG9nZ2xlKHRoaXNUYXJnZXQsICdzaG93Jyk7XG5cdFx0XHRicmVhaztcblxuXHRcdFx0ZGVmYXVsdDogY29uc29sZS5lcnJvcignbm8gY29ycmVjdCBcImRhdGEtYnV0dG9uLXR5cGVcIiBhdHRyaWJ1dGUgaXMgc2V0IHRvIHRoZSBidXR0b24gZWxlbWVudCBpbiBIVE1MIScpO1xuXHRcdH1cblxuXHR9XG5cblx0Ly8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuXHRmdW5jdGlvbiB0YXJnZXRzRm9yQWN0aW9uKGJ1dHRvbkVsZW1lbnQsIGJ1dHRvbkRhdGEpIHtcblx0XHRsZXQgdGFyZ2V0c0ZvckFjdGlvbklkID0gYnV0dG9uRGF0YS50YXJnZXQgPyBidXR0b25EYXRhLnRhcmdldC5zcGxpdCgnICcpIDogbnVsbCxcblx0XHQgXHRcdHRhcmdldHNGb3JBY3Rpb24gPSBbXTtcblxuXHRcdGlmICh0YXJnZXRzRm9yQWN0aW9uSWQpIHtcblx0XHRcdGZvciAobGV0IGkgPSAwOyBpIDwgdGFyZ2V0c0ZvckFjdGlvbklkLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRcdHRhcmdldHNGb3JBY3Rpb24ucHVzaCggZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQodGFyZ2V0c0ZvckFjdGlvbklkW2ldKSApO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdHJldHVybiB0YXJnZXRzRm9yQWN0aW9uO1xuXHR9XG5cblx0ZnVuY3Rpb24gdGFyZ2V0c0ZvclJldmVyc2VBY3Rpb24oYnV0dG9uRWxlbWVudCwgYnV0dG9uRGF0YSkge1xuXHRcdGxldFx0dGFyZ2V0c0ZvclJldmVyc2VBY3Rpb25JZCA9IGJ1dHRvbkRhdGEudGFyZ2V0UmV2ZXJzZSA/IGJ1dHRvbkRhdGEudGFyZ2V0UmV2ZXJzZS5zcGxpdCgnICcpIDogbnVsbCxcblx0XHRcdFx0dGFyZ2V0c0ZvckFjdGlvbkdyb3VwID0gYnV0dG9uRGF0YS5ncm91cCA/IGJ1dHRvbkRhdGEuZ3JvdXAgOiBudWxsLFxuXHRcdFx0XHR0YXJnZXRzRm9yUmV2ZXJzZUFjdGlvbiA9IFtdO1x0XG5cblx0XHRpZiAodGFyZ2V0c0ZvclJldmVyc2VBY3Rpb25JZCkge1xuXHRcdFx0Zm9yIChsZXQgaSA9IDA7IGkgPCB0YXJnZXRzRm9yUmV2ZXJzZUFjdGlvbklkLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRcdHRhcmdldHNGb3JSZXZlcnNlQWN0aW9uLnB1c2goIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHRhcmdldHNGb3JSZXZlcnNlQWN0aW9uSWRbaV0pICk7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdGlmICh0YXJnZXRzRm9yQWN0aW9uR3JvdXApIHtcblx0XHRcdHRhcmdldHNGb3JSZXZlcnNlQWN0aW9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSh0YXJnZXRzRm9yQWN0aW9uR3JvdXApO1xuXHRcdH1cblxuXHRcdHJldHVybiB0YXJnZXRzRm9yUmV2ZXJzZUFjdGlvbjtcblx0fVxuXG5cdGZ1bmN0aW9uIHRoaXNDb250ZW50VGFyZ2V0KGJ1dHRvbkVsZW1lbnQsIGJ1dHRvbkRhdGEpIHtcblx0XHRsZXQgdGhpc1RhcmdldCA9IGJ1dHRvbkRhdGEuZ3JvdXAgPyBidXR0b25FbGVtZW50LnBhcmVudEVsZW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShidXR0b25EYXRhLmdyb3VwKSA6IG51bGw7XG5cdFx0cmV0dXJuIHRoaXNUYXJnZXQ7XG5cdH1cblxuXHRmdW5jdGlvbiB0YXJnZXRzRm9yUmV2ZXJzZUFjdGlvbkJ1dHRvbnMoYnV0dG9uRWxlbWVudCwgYnV0dG9uRGF0YSkge1xuXHRcdGxldCB0YXJnZXRCdXR0b25zID0gW107XG5cblx0XHRpZiAoYnV0dG9uRGF0YS5ncm91cCkge1xuXHRcdFx0bGV0IGJ1dHRvbnNBbGwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuc2hvd0J1dHRvbltkYXRhLWdyb3VwPVwiJyArIGJ1dHRvbkRhdGEuZ3JvdXAgKyAnXCJdJyApO1xuXG5cdFx0XHRpZiAoYnV0dG9uc0FsbCkge1xuXHRcdFx0XHRmb3IgKGxldCBpID0gMDsgaSA8IGJ1dHRvbnNBbGwubGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0XHRidXR0b25zQWxsW2ldID09PSBidXR0b25FbGVtZW50ID8gbnVsbCA6IHRhcmdldEJ1dHRvbnMucHVzaChidXR0b25zQWxsW2ldKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblxuXHRcdHJldHVybiB0YXJnZXRCdXR0b25zO1x0XG5cdH1cblxuXG5cdC8vIC0tLS1TaG93IENvbnRlbnQgQWN0aW9ucyAtLS0tLS0tLS1cblx0JCgnYm9keScpLm9uKCdjbGljaycsICcuc2hvd0J1dHRvbicsIGZ1bmN0aW9uKCkge1xuXHRcdC8vIGNvbnNvbGUudGltZSgnY2xpY2sgdG9nZ2xlIHdvcmtpbmcgdGltZScpO1xuXG5cdFx0bGV0IHRhcmdldENvbnRlbnREYXRhID0ge307XG5cblxuXHRcdC8vIC0tLS0tIHRhcmdldENvbnRlbnREYXRhIGNvbnN0cnVjdG9yLS0tLS0tXG5cdFx0aWYgKHRoaXMpIHtcblx0XHRcdGxldCBidXR0b25EYXRhID0gdGhpcy5kYXRhc2V0O1xuXG5cdFx0XHQvLyBjb25zb2xlLmxvZyhidXR0b25EYXRhKVxuXHRcdFx0dGFyZ2V0Q29udGVudERhdGEgPSB7fTtcblx0XHRcdHRhcmdldENvbnRlbnREYXRhLmJ1dHRvbkRhdGEgPSBidXR0b25EYXRhO1xuXHRcdFx0dGFyZ2V0Q29udGVudERhdGEudGFyZ2V0cyA9IHRhcmdldHNGb3JBY3Rpb24odGhpcywgYnV0dG9uRGF0YSApO1xuXHRcdFx0dGFyZ2V0Q29udGVudERhdGEudGFyZ2V0c1JldmVyc2UgPSB0YXJnZXRzRm9yUmV2ZXJzZUFjdGlvbih0aGlzLCBidXR0b25EYXRhICk7XG5cblx0XHRcdGlmIChidXR0b25EYXRhLmJ1dHRvblR5cGUgPT09IFwiYWNjb3JkaW9uXCIpIHtcblx0XHRcdFx0dGFyZ2V0Q29udGVudERhdGEudGhpc0NvbnRlbnQgPSB0aGlzQ29udGVudFRhcmdldCh0aGlzLCBidXR0b25EYXRhKTtcblx0XHRcdFx0dGFyZ2V0Q29udGVudERhdGEudGFyZ2V0QnV0dG9ucyA9IHRhcmdldHNGb3JSZXZlcnNlQWN0aW9uQnV0dG9ucyh0aGlzLCBidXR0b25EYXRhKTtcblx0XHRcdH1cblxuXHRcdFx0Ly8gLS0tLS0tLS1BY3Rpb25zL0V2ZW50cy0tLS0tLS0tXG5cblx0XHRcdGlmIChidXR0b25EYXRhLmJ1dHRvblR5cGUgPT09IFwibWVudUJ1dHRvblwiKSB7XG5cdFx0XHRcdGdsb2JGdW5jLnRvZ2dsZUJ1dHRvbkNvbnRlbnQodGhpcyk7XG5cdFx0XHRcdHRoaXMuY2xhc3NMaXN0LmNvbnRhaW5zKCdhY3RpdmUnKSA/IFxuXHRcdFx0XHRcdGdsb2JGdW5jLnNob3dPdmVybGF5KFwibWVudVwiLCBnbG9iLnBhZ2VPdmVybGF5KSA6IFxuXHRcdFx0XHRcdGdsb2JGdW5jLmhpZGVPdmVybGF5KFwibWVudVwiLCBnbG9iLnBhZ2VPdmVybGF5KTtcblxuXHRcdFx0XHR0b2dnbGVDb250ZW50KHRoaXMsIHRhcmdldENvbnRlbnREYXRhKTtcblxuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0Z2xvYkZ1bmMudG9nZ2xlQnV0dG9uQ29udGVudCh0aGlzKTtcblx0XHRcdFx0dG9nZ2xlQ29udGVudCh0aGlzLCB0YXJnZXRDb250ZW50RGF0YSk7XHRcdFx0XHRcblx0XHRcdH1cblxuXHRcdH1cblx0XHQvLyBjb25zb2xlLnRpbWVFbmQoJ2NsaWNrIHRvZ2dsZSB3b3JraW5nIHRpbWUnKTtcblx0XHRcdFxuXHR9KTtcblxuXG59KSgpOyovXG4gIC8qZ2xvYi5Td2l0Y2hUYWJzTW9kdWxlICA9IChmdW5jdGlvbigpIHtcblxuXHRjb25zdCBkZWZhdWx0VGFic0J1dHRvbnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcudGFic05hdiAudGFiQnV0dG9uJyksXG5cdGRlZmF1bHRUYWJzQmxvY2tzQ29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnRvZ2dsZUJsb2Nrcy1saXN0JyksXG5cdGRlZmF1bHRUYWJzQmxvY2tzTGlzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy50b2dnbGVCbG9jaycpO1xuXG5cblx0ZnVuY3Rpb24gc3dpdGNoVGFicyh0YWJCdXR0b24sIHRhYnNCbG9ja3MsIHRhYkJ1dHRvbnMpIHtcblx0XHRsZXQgdGFyZ2V0ID0gdGFiQnV0dG9uLmRhdGFzZXQudGFyZ2V0O1xuXG5cdFx0aWYgKCAhdGFiQnV0dG9uLmNsYXNzTGlzdC5jb250YWlucygnYWN0aXZlJykgKSB7XG5cdFx0XHRmb3IgKGxldCBpID0gMDsgaSA8IHRhYnNCbG9ja3MubGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0dGFiQnV0dG9uc1tpXS5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKTtcblx0XHRcdFx0dGFic0Jsb2Nrc1tpXS5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKTtcblxuXHRcdFx0XHRpZiAodGFyZ2V0ID09PSB0YWJzQmxvY2tzW2ldLmlkKSB7XG5cdFx0XHRcdFx0dGFiQnV0dG9uLmNsYXNzTGlzdC5hZGQoJ2FjdGl2ZScpOyBcblx0XHRcdFx0XHR0YWJzQmxvY2tzW2ldLmNsYXNzTGlzdC5hZGQoJ2FjdGl2ZScpOyBcblx0XHRcdFx0fSBcblxuXHRcdFx0fVxuXHRcdH1cblx0fVxuXG4gIC8vIC0tLWV2ZW50cy0tLVxuXG4gICQoJy50YWJzTmF2Jykub24oJ2NsaWNrJywgJy50YWJCdXR0b24nLCBmdW5jdGlvbigpIHtcbiAgXHRcdHZhciB0YWJzR3JvdXAgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKHRoaXMuZGF0YXNldC50YWJzR3JvdXApXG4gIFx0XHR2YXIgdGFiQnV0dG9ucyA9IHRoaXMucGFyZW50RWxlbWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCd0YWJCdXR0b24nKVxuICBcdFx0dmFyIHRhYnNCbG9ja3NDb250YWluZXIgPSB0aGlzLnBhcmVudEVsZW1lbnQucGFyZW50RWxlbWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKHRoaXMuZGF0YXNldC50YWJzQ29udGFpbmVyKVswXVxuXG4gIFx0XHQvLyBjb25zb2xlLmxvZyh0YWJCdXR0b25zKVxuICBcdFx0Ly8gY29uc29sZS5sb2codGFic0Jsb2Nrc0NvbnRhaW5lcilcbiAgXHRcdGlmICh0YWJzR3JvdXAubGVuZ3RoKSB7XHRzd2l0Y2hUYWJzKHRoaXMsIHRhYnNHcm91cCwgdGFiQnV0dG9ucyk7fVxuICBcdFx0ZWxzZSB7IHN3aXRjaFRhYnModGhpcywgZGVmYXVsdFRhYnNCbG9ja3NMaXN0LCB0YWJCdXR0b25zKTtcdH1cblxuICBcdFx0aWYgKHRhYnNCbG9ja3NDb250YWluZXIpIHtnbG9iRnVuYy5hbmltYXRlQmxvY2sodGFic0Jsb2Nrc0NvbnRhaW5lcik7fVxuICBcdFx0ZWxzZSB7Z2xvYkZ1bmMuYW5pbWF0ZUJsb2NrKGRlZmF1bHRUYWJzQmxvY2tzQ29udGFpbmVyKTt9XHQgIFx0XHRcbiAgfSlcblxuXG59KSgpOyovXG4gIC8qZ2xvYi5UZXh0TGltaXRNb2R1bGUgID0gKGZ1bmN0aW9uKCkge1xuXHRjb25zb2xlLmxvZygnVGV4dExpbWl0TW9kdWxlIG9rJyk7XG5cblx0ZnVuY3Rpb24gc2xpY2VUZXh0KHNsaWNpbmdCbG9ja3MsIG1heExlbmd0aCkge1xuXHRcdGlmIChzbGljaW5nQmxvY2tzKSB7XG5cblx0XHRcdGZvciAobGV0IGkgPSAwOyBpIDwgc2xpY2luZ0Jsb2Nrcy5sZW5ndGg7IGkrKykge1xuXHRcdFx0XHRsZXQgY3VycmVudFRleHQgPSBzbGljaW5nQmxvY2tzW2ldLmlubmVySFRNTDtcblxuXHRcdFx0XHRpZiAoY3VycmVudFRleHQubGVuZ3RoID4gbWF4TGVuZ3RoKSB7XG5cdFx0XHRcdFx0c2xpY2luZ0Jsb2Nrc1tpXS5pbm5lckhUTUwgPSBjdXJyZW50VGV4dC5zbGljZSgwLCBtYXhMZW5ndGgpICsgJyAuLi4nO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cblx0XHR9XG5cdH1cblx0XG5cdHJldHVybiB7XG5cdFx0c2xpY2VUZXh0OiBzbGljZVRleHQsXG5cdH1cblxufSkoKTsqL1xuICAvKmdsb2IuU3RpY2t5QmxvY2tNb2R1bGUgPSAoZnVuY3Rpb24oKSB7XG5cbiAgdmFyIHRhcmdldDtcbiAgdmFyIHJlbGF0aXZlO1xuICB2YXIgaXNBY3RpdmUgPSBmYWxzZTtcblxuICBmdW5jdGlvbiB0b1N0aWNrKHRhcmdldEJsb2NrLCByZWxhdGl2ZUJsb2NrKSB7XG4gICAgdGFyZ2V0ID0gdGFyZ2V0QmxvY2s7XG4gICAgcmVsYXRpdmUgPSByZWxhdGl2ZUJsb2NrO1xuICAgIGlzQWN0aXZlID0gdHJ1ZTtcbiAgICAvLyBjbCgnYWN0aXZhdGUgJywgaXNBY3RpdmUpXG5cbiAgICB0b1Njcm9sbChpc0FjdGl2ZSlcbiAgfVxuXG4gIGZ1bmN0aW9uIHVuU3RpY2soKSB7XG4gICAgaXNBY3RpdmUgPSBmYWxzZTtcbiAgICAvLyBjbCgnZGVhY3RpdmF0ZScpXG4gICAgdG9TY3JvbGwoaXNBY3RpdmUpICAgIFxuICB9XG4gIFxuICBmdW5jdGlvbiBjaGVja1Bvc2l0aW9uKHRhcmdldEJsb2NrLCByZWxhdGl2ZUJsb2NrKSB7XG4gICAgaWYgKCAhZ2xvYkZ1bmMuaXNWaXNpYmxlKHJlbGF0aXZlQmxvY2ssICd0b3BCb3JkZXInKSApIHtcblxuICAgICAgaWYgKCAhdGFyZ2V0QmxvY2suY2xhc3NMaXN0LmNvbnRhaW5zKCdqc19maXhlZF9uYXYnKSApIHtcbiAgICAgICAgdGFyZ2V0QmxvY2suc3R5bGUud2lkdGggPSB0YXJnZXRCbG9jay5vZmZzZXRXaWR0aCArICdweCc7XG4gICAgICAgIHRhcmdldEJsb2NrLmNsYXNzTGlzdC5hZGQoJ2pzX2ZpeGVkX25hdicpO1xuICAgICAgfVxuXG4gICAgICBpZiAoZ2xvYkZ1bmMuZ2V0Q29vcmRzT25TY3JlZW4odGFyZ2V0QmxvY2spLmJvdHRvbSA+PSBnbG9iRnVuYy5nZXRDb29yZHNPblNjcmVlbihyZWxhdGl2ZUJsb2NrKS5ib3R0b20pIHtcbiAgICAgICAgdGFyZ2V0QmxvY2suY2xhc3NMaXN0LmFkZCgnanNfYWJzb2x1dGVfbmF2Jyk7XG4gICAgICAgIHRhcmdldEJsb2NrLmNsYXNzTGlzdC5yZW1vdmUoJ2pzX2ZpeGVkX25hdicpO1xuICAgICAgfVxuXG4gICAgICBpZiAoIHRhcmdldEJsb2NrLmNsYXNzTGlzdC5jb250YWlucygnanNfYWJzb2x1dGVfbmF2JykgKSB7XG4gICAgICAgIGlmIChnbG9iRnVuYy5pc1Zpc2libGUodGFyZ2V0QmxvY2ssIFwidG9wQm9yZGVyXCIpKSB7XG4gICAgICAgICAgdGFyZ2V0QmxvY2suY2xhc3NMaXN0LnJlbW92ZSgnanNfYWJzb2x1dGVfbmF2Jyk7XG4gICAgICAgICAgdGFyZ2V0QmxvY2suY2xhc3NMaXN0LmFkZCgnanNfZml4ZWRfbmF2Jyk7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgIH0gZWxzZSB7XG4gICAgICBpZiAoIHRhcmdldEJsb2NrLmNsYXNzTGlzdC5jb250YWlucygnanNfZml4ZWRfbmF2JykgKSB7XG4gICAgICAgIHRhcmdldEJsb2NrLnN0eWxlLndpZHRoID0gJyc7XG4gICAgICAgIHRhcmdldEJsb2NrLmNsYXNzTGlzdC5yZW1vdmUoJ2pzX2ZpeGVkX25hdicpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIHRvU2Nyb2xsKHN0YXR1cykge1xuICAgIGlmIChzdGF0dXMpIHtcbiAgICAgICQod2luZG93KS5zY3JvbGwoZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAodGFyZ2V0ICYmIHJlbGF0aXZlKSB7XG4gICAgICAgICAgY2hlY2tQb3NpdGlvbih0YXJnZXQsIHJlbGF0aXZlKVxuICAgICAgICB9XG4gICAgICB9KVxuICAgIH1cbiAgfVxuICBcbiAgXG5cbiAgcmV0dXJuIHtcbiAgICB0b1N0aWNrOiB0b1N0aWNrLFxuICAgIHVuU3RpY2s6IHVuU3RpY2ssXG4gIH1cblxufSkoKSovXG4gIC8qZ2xvYi5MYXp5TG9hZE1vZHVsZSAgPSAoZnVuY3Rpb24oKSB7XG5cdHZhciBsYXp5QmxvY2tzID0gW11cblxuXHRmdW5jdGlvbiBpbml0KHNlbGVjdG9yKSB7XG5cdFx0c2V0TGF6eShzZWxlY3Rvcik7XG5cdFx0bGF6eUxvYWQobGF6eUJsb2Nrcyk7XG5cdH1cblxuXHRmdW5jdGlvbiBzZXRMYXp5KGNsYXNzU2VsZWN0b3Ipe1xuXHRcdC8vIGNvbnNvbGUubG9nKHNlbGVjdG9yKVxuXHRcdGxhenlCbG9ja3MgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKGNsYXNzU2VsZWN0b3IpO1xuXHRcdFx0Ly8gY2wobGF6eUJsb2Nrcy5sZW5ndGgpXG5cdFx0aWYgKGxhenlCbG9ja3MubGVuZ3RoKSB7XG5cdFx0XHRmb3IgKHZhciBpID0gMDsgaSA8IGxhenlCbG9ja3MubGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0aWYgKCFsYXp5QmxvY2tzW2ldLmdldEF0dHJpYnV0ZSgnaGFzLXByZWxvYWRlcicpKSB7XG5cdFx0XHRcdFx0dmFyIHByZWxvYWRlciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuXHRcdFx0XHRcdHByZWxvYWRlci5jbGFzc05hbWUgPSAnaW1nUHJlbG9hZGVyJztcblx0XHRcdFx0XHRwcmVsb2FkZXIuaW5uZXJIVE1MID0gJzxpbWcgc3JjPVwiL2ltZy9pY29ucy9sYXp5X3ByZWxvYWRlci5qcGdcIiBhbHQ9XCJsb2FkZXJcIj4nXG5cdFx0XHRcdFx0bGF6eUJsb2Nrc1tpXS5wYXJlbnRFbGVtZW50LmFwcGVuZENoaWxkKHByZWxvYWRlcik7XG5cdFx0XHRcdFx0bGF6eUJsb2Nrc1tpXS5zZXRBdHRyaWJ1dGUoJ2hhcy1wcmVsb2FkZXInLCB0cnVlKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cbiAgICAvLyBjb25zb2xlLmxvZygnRm91bmQgJyArIGxhenlCbG9ja3MubGVuZ3RoICsgJyBsYXp5IGltYWdlcycpO1xuXHR9XG5cblx0ZnVuY3Rpb24gbG9hZGVkKGVsKSB7XG4gICAgLy8gZWwucmVtb3ZlQXR0cmlidXRlKCdkYXRhLXNyYycpO1xuICAgIC8vIGVsLmNsYXNzTGlzdC5yZW1vdmUoJ2xhenlCbG9jaycpO1xuXHRcdGxldCBsb2FkZXIgPSBlbC5wYXJlbnRFbGVtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ2ltZ1ByZWxvYWRlcicpWzBdO1xuXHRcdGlmIChsb2FkZXIpICQobG9hZGVyKS5mYWRlT3V0KCk7XG5cdFx0Ly8gY2xlYW5MYXp5KClcblx0fVxuXG5cdGZ1bmN0aW9uIGxvYWRJbWFnZShlbGVtZW50KSB7XG5cdFx0aWYoIGlzSW5WaWV3cG9ydChlbGVtZW50KSApIHtcbiAgICAgIGVsZW1lbnQuc2V0QXR0cmlidXRlKCdpc0xvYWRpbmcnLCB0cnVlKTtcblxuXHRcdFx0aWYgKGVsZW1lbnQudGFnTmFtZSAhPT0gJ0lNRycpIHtcblx0XHRcdFx0dmFyIGltZyA9IG5ldyBJbWFnZSgpO1xuXHRcdFx0XHR2YXIgc3JjRGF0YSA9IGVsZW1lbnQuZ2V0QXR0cmlidXRlKCdkYXRhLXNyYycpO1xuXHRcdFx0XHRpZiAoc3JjRGF0YSkgeyBcblx0XHRcdFx0XHRpbWcub25sb2FkID0gZnVuY3Rpb24oKXtcblx0XHRcdFx0XHQgIGVsZW1lbnQuc3R5bGUuYmFja2dyb3VuZEltYWdlID0gJ3VybCgnICsgaW1nLmdldEF0dHJpYnV0ZSgnc3JjJykgKyAnKSc7XG5cdFx0XHRcdFx0ICBsb2FkZWQoZWxlbWVudCk7XG5cdFx0XHRcdFx0fTtcblxuXHRcdFx0XHRcdC8vIGVsZW1lbnQucmVtb3ZlQXR0cmlidXRlKCdkYXRhLXNyYycpO1xuXHRcdFx0XHRcdGltZy5zZXRBdHRyaWJ1dGUoJ3NyYycsIHNyY0RhdGEpOyBcblx0XHRcdFx0fVxuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0dmFyIHNyY0RhdGEgPSBlbGVtZW50LmdldEF0dHJpYnV0ZSgnZGF0YS1zcmMnKTtcblx0XHRcdFx0aWYgKHNyY0RhdGEpe1xuXHRcdFx0XHRcdGVsZW1lbnQub25sb2FkID0gZnVuY3Rpb24oKXtcblx0XHRcdFx0XHQgIGxvYWRlZChlbGVtZW50KTtcblx0XHRcdFx0XHR9O1xuXG5cdFx0XHRcdFx0ZWxlbWVudC5zZXRBdHRyaWJ1dGUoJ3NyYycsIHNyY0RhdGEpOyBcblx0XHRcdFx0XHQvLyBlbGVtZW50LnJlbW92ZUF0dHJpYnV0ZSgnZGF0YS1zcmMnKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblx0fVxuXG5cdGZ1bmN0aW9uIGxhenlMb2FkKGxhenlCbG9ja3MpIHtcblx0XHQvLyBpZiAobGF6eUJsb2Nrcy5sZW5ndGgpIHtcblx0XHRcdGxldCBsYXp5QiA9IGxhenlCbG9ja3M7XG5cdFx0XHRmb3IgKGxldCBpID0gMDsgaSA8IGxhenlCLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRcdHZhciBpc0xvYWRpbmcgPSBsYXp5QltpXS5nZXRBdHRyaWJ1dGUoJ2lzTG9hZGluZycpO1xuXHRcdFx0XHRpZiAoIGlzTG9hZGluZyAhPSAndHJ1ZScgKSB7XG5cdFx0XHRcdFx0bG9hZEltYWdlKGxhenlCW2ldKTtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRjbGVhbkxhenkoKVxuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0XHQvLyBjbGVhbkxhenkoKVxuXHRcdC8vIH1cblx0fVxuXG5cdGZ1bmN0aW9uIGNsZWFuTGF6eSgpe1xuXHRcdGlmIChsYXp5QmxvY2tzLmxlbmd0aCkge1xuXHRcdFx0bGF6eUJsb2NrcyA9ICBBcnJheS5wcm90b3R5cGUuZmlsdGVyLmNhbGwobGF6eUJsb2NrcywgZnVuY3Rpb24obCl7IHJldHVybiBsLmdldEF0dHJpYnV0ZSgnaXNMb2FkaW5nJykgIT0gJ3RydWUnO30pO1xuXHRcdH1cblx0ICAgIC8vIGNsKGxhenlCbG9ja3MubGVuZ3RoKVxuXHR9XG5cblxuXHRmdW5jdGlvbiBpc0luVmlld3BvcnQoZWwpe1xuICAgIHZhciByZWN0ID0gZWwuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG4gICAgXG4gICAgcmV0dXJuIChcbiAgICAgICAgcmVjdC5ib3R0b20gPj0gMCAmJiBcbiAgICAgICAgLy8gcmVjdC5yaWdodCA+PSAwICYmIFxuICAgICAgICByZWN0LnRvcCA8PSAod2luZG93LmlubmVySGVpZ2h0IHx8IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGllbnRIZWlnaHQpXG4gICAgICAgIC8vIHJlY3QubGVmdCA8PSAod2luZG93LmlubmVyV2lkdGggfHwgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsaWVudFdpZHRoKVxuICAgICk7XG5cdH1cblxuXHR2YXIgdGltZXIgPSBudWxsO1xuXHQkKHdpbmRvdykuc2Nyb2xsKGZ1bmN0aW9uICgpIHtcblx0XHRpZiAodGltZXIpIHsgY2xlYXJUaW1lb3V0KHRpbWVyKTsgfVxuXG5cdCAgdGltZXIgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgIFx0dGltZXIgPSBudWxsO1xuXHQgICAgXG5cdCAgICAvLyBzZXRMYXp5KCk7XG5cdCAgICAvLyBjbChsYXp5QmxvY2tzLmxlbmd0aClcblx0ICAgIGlmIChsYXp5QmxvY2tzLmxlbmd0aCkgeyBsYXp5TG9hZChsYXp5QmxvY2tzKTsgfVxuXG5cdCAgfSwgNTApO1xuXHR9KVxuXG5cdC8vIC0tLS0tLS0tLS0tLVxuXG5cdHJldHVybiB7XG5cdCAgaW5pdExhenk6IGluaXQsXG5cdCAgLy8gbGF6eUxvYWQ6IGxhenlMb2FkLFxuXHR9XG5cblxufSkoKTsqL1xuICAvKmdsb2IuT3BlbkNsb3NlTW9kdWxlICA9IChmdW5jdGlvbigpIHtcblx0Ly8gY29uc29sZS5sb2coJ09wZW5DbG9zZU1vZHVsZSBvaycpO1xuXHQvLyBjb25zb2xlLnRpbWUoJ1RvZ2dsZUNvbnRlbnQgTW9kdWxlIGxvYWQnKTtcblxuXHRmdW5jdGlvbiBpbml0aWF0ZShidXR0b25FbGVtZW50KSB7XG5cdFx0bGV0IGJ1dHRvbiA9IGJ1dHRvbkVsZW1lbnQsXG5cdFx0XHRcdGJ1dHRvbkRhdGEgPSBidXR0b24uZGF0YXNldCxcblx0XHRcdFx0dGFyZ2V0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoYnV0dG9uRGF0YS50YXJnZXQpLFxuXHRcdFx0XHRjb250cm9sQ2xhc3MgPSBidXR0b25EYXRhLmNsYXNzO1xuXG5cdFx0Ly8gLS0tLS0tTWV0aG9kcy0tLS0tLS0tXG5cdFx0aWYgKHRhcmdldCAmJiBjb250cm9sQ2xhc3MpIHtcblxuXHRcdFx0aWYgKGJ1dHRvbkRhdGEuYWN0aW9uKSB7XG5cdFx0XHRcdGlmIChidXR0b25EYXRhLmFjdGlvbiA9PSAnb3BlbicpIHtcblx0XHRcdFx0XHRnbG9iRnVuYy50b2dnbGVCdXR0b25Db250ZW50KGJ1dHRvbik7XG5cdFx0XHRcdFx0dGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhjb250cm9sQ2xhc3MpID8gbnVsbCA6IHRhcmdldC5jbGFzc0xpc3QuYWRkKGNvbnRyb2xDbGFzcyk7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRpZiAoYnV0dG9uRGF0YS5hY3Rpb24gPT0gJ2Nsb3NlJykge1xuXHRcdFx0XHRcdHZhciB0aGlzR3JvdXBPcGVuQnV0dG9ucyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5vcGVuQnV0dG9uW2RhdGEtdGFyZ2V0PVwiJyArIGJ1dHRvbkRhdGEudGFyZ2V0ICsgJ1wiXScgKTtcblx0XHRcdFx0XHRpZiAodGhpc0dyb3VwT3BlbkJ1dHRvbnMubGVuZ3RoKSB7XG5cdFx0XHRcdFx0XHRmb3IgKHZhciBpID0gMDsgaSA8IHRoaXNHcm91cE9wZW5CdXR0b25zLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRcdFx0XHRcdHRoaXNHcm91cE9wZW5CdXR0b25zW2ldLmRhdGFzZXQuYWN0aW9uID09ICdvcGVuJyA/IGdsb2JGdW5jLnRvZ2dsZUJ1dHRvbkNvbnRlbnQodGhpc0dyb3VwT3BlbkJ1dHRvbnNbaV0pIDogbnVsbDtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0dGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhjb250cm9sQ2xhc3MpID8gdGFyZ2V0LmNsYXNzTGlzdC5yZW1vdmUoY29udHJvbENsYXNzKSA6IG51bGw7XG5cdFx0XHRcdH1cblx0XHRcdH1cdGVsc2UgeyBcblx0XHRcdFx0Z2xvYkZ1bmMudG9nZ2xlQnV0dG9uQ29udGVudChidXR0b24pO1xuXHRcdFx0XHR0YXJnZXQuY2xhc3NMaXN0LnRvZ2dsZShjb250cm9sQ2xhc3MpO1xuXHRcdFx0fVxuXHRcdFx0XG5cdFx0fVx0XHRcdFxuXHR9XG5cblx0Ly8gLS0tLVNob3cgQ29udGVudCBBY3Rpb25zIC0tLS0tLS0tLVxuXHQkKCdib2R5Jykub24oJ2NsaWNrJywgJy5vcGVuQnV0dG9uJywgZnVuY3Rpb24oKSB7XG5cdFx0Ly8gY29uc29sZS50aW1lKCdjbGljayB0b2dnbGUgd29ya2luZyB0aW1lJyk7XG5cblx0XHQvLyAtLS0tLS0tLUFjdGlvbnMvRXZlbnRzLS0tLS0tLS1cblxuXHRcdC8vIGdsb2JGdW5jLnRvZ2dsZUJ1dHRvbkNvbnRlbnQodGhpcyk7XG5cdFx0aW5pdGlhdGUodGhpcyk7XHRcdFx0XHRcblx0XHQvLyBjb25zb2xlLnRpbWVFbmQoJ2NsaWNrIHRvZ2dsZSB3b3JraW5nIHRpbWUnKTtcblx0XHRcdFxuXHR9KTtcblxuXG59KSgpOyovXG4gIC8qZ2xvYi5SYWRpb09wZW5DbG9zZU1vZHVsZSAgPSAoZnVuY3Rpb24oKSB7XG5cdC8vIGNvbnNvbGUubG9nKCdPcGVuQ2xvc2VNb2R1bGUgb2snKTtcblx0Ly8gY29uc29sZS50aW1lKCdUb2dnbGVDb250ZW50IE1vZHVsZSBsb2FkJyk7XG5cblx0ZnVuY3Rpb24gaGlkZUdyb3VwKGdyb3VwTmFtZSwgY29udHJvbENsYXNzKSB7XG5cdFx0dmFyIGdyb3VwQmxvY2tzID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShncm91cE5hbWUpO1xuXG5cdFx0aWYgKGdyb3VwQmxvY2tzLmxlbmd0aCkge1xuXHRcdFx0Zm9yIChsZXQgaSA9IDA7IGkgPCBncm91cEJsb2Nrcy5sZW5ndGg7IGkrKykge1xuXHRcdFx0XHRncm91cEJsb2Nrc1tpXS5jbGFzc0xpc3QuY29udGFpbnMoY29udHJvbENsYXNzKSA/IGdyb3VwQmxvY2tzW2ldLmNsYXNzTGlzdC5yZW1vdmUoY29udHJvbENsYXNzKSA6IG51bGw7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdH1cblxuXHRmdW5jdGlvbiBpbml0aWF0ZShidXR0b25zKSB7XG5cdFx0dmFyIGJ1dHRvbixcblx0XHRcdFx0YnV0dG9uRGF0YSxcblx0XHRcdFx0dGFyZ2V0LFxuXHRcdFx0XHRjb250cm9sQ2xhc3MsXG5cdFx0XHRcdGlzR3JvdXBDaGFuZ2UsIGN1cnJlbnRHcm91cDtcblx0XHRcblx0XHRmb3IgKHZhciBpID0gMDsgaSA8IGJ1dHRvbnMubGVuZ3RoOyBpKyspIHtcblx0XHRcdGJ1dHRvbiA9IGJ1dHRvbnNbaV0sXG5cdFx0XHRidXR0b25EYXRhID0gYnV0dG9uLmRhdGFzZXQsXG5cdFx0XHR0YXJnZXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChidXR0b25EYXRhLnRhcmdldCksXG5cdFx0XHRjb250cm9sQ2xhc3MgPSBidXR0b25EYXRhLmNsYXNzO1xuXHRcdFx0aXNHcm91cENoYW5nZSA9IGN1cnJlbnRHcm91cCA9PT0gYnV0dG9uLm5hbWUgPyBmYWxzZSA6IHRydWU7XG5cdFx0XHRjdXJyZW50R3JvdXAgPSBidXR0b24ubmFtZTtcblxuXHRcdFx0aWYgKGlzR3JvdXBDaGFuZ2UpIHtcblx0XHRcdFx0aGlkZUdyb3VwKGN1cnJlbnRHcm91cCwgY29udHJvbENsYXNzKVxuXHRcdFx0fVxuXG5cdFx0XHRpZiAoYnV0dG9uLmNoZWNrZWQgJiYgdGFyZ2V0KSB7XG5cdFx0XHRcdHRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoY29udHJvbENsYXNzKSA/IG51bGwgOiB0YXJnZXQuY2xhc3NMaXN0LmFkZChjb250cm9sQ2xhc3MpO1xuXHRcdFx0fVx0XHRcdFxuXHRcdH1cblx0XG5cdH1cblxuXHR2YXIgYWxsUmFkaW9CdXR0b25zID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgncmFkaW9CdXR0b24nKTtcblxuXHRpZiAoYWxsUmFkaW9CdXR0b25zLmxlbmd0aCkgeyBpbml0aWF0ZShhbGxSYWRpb0J1dHRvbnMpfVxuXHQvLyAtLS0tU2hvdyBDb250ZW50IEFjdGlvbnMgLS0tLS0tLS0tXG5cdCQoJ2JvZHknKS5vbignY2xpY2snLCAnLnJhZGlvQnV0dG9uJywgZnVuY3Rpb24oKSB7XG5cdFx0Ly8gY29uc29sZS50aW1lKCdjbGljayB0b2dnbGUgd29ya2luZyB0aW1lJyk7XG5cblx0XHQvLyAtLS0tLS0tLUFjdGlvbnMvRXZlbnRzLS0tLS0tLS1cblx0XHR2YXIgYnV0dG9uID0gW107XG5cdFx0YnV0dG9uLnB1c2godGhpcylcblx0XHQvLyBnbG9iRnVuYy50b2dnbGVCdXR0b25Db250ZW50KHRoaXMpO1xuXHRcdGluaXRpYXRlKGJ1dHRvbik7XHRcdFx0XHRcblx0XHQvLyBjb25zb2xlLnRpbWVFbmQoJ2NsaWNrIHRvZ2dsZSB3b3JraW5nIHRpbWUnKTtcblx0XHRcdFxuXHR9KTtcblxuXG59KSgpOyovXG4gXG5cdC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblx0Z2xvYi5uYXZNZW51V3JhcHBlciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCduYXZNZW51V3JhcHBlcicpO1xuXHRnbG9iLm5hdk1lbnUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbmF2TWVudScpO1xuXHRnbG9iLnBhZ2VPdmVybGF5ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3BhZ2VPdmVybGF5Jyk7XG5cblx0aWYgKCEkKCdib2R5JykpIHtjb25zb2xlLmxvZygnalF1ZXJ5IEVycm9yJyl9XG5cdC8vIGNvbnNvbGUubG9nKHRlc3QpO1xuXG5cdC8qJCgnLm1haW5IZWFkZXInKS5vbignY2xpY2snLCAnLm1lbnUtYnV0dG9uJywgZnVuY3Rpb24oZSkge1xuXHRcdGdsb2JGdW5jLnRvZ2dsZUJ1dHRvbkNvbnRlbnQodGhpcylcdFxuXHR9KVxuXG5cdCQoJy5tYWluSGVhZGVyJykub24oJ2JsdXInLCAnLm1lbnUtYnV0dG9uJywgZnVuY3Rpb24oKSB7XG5cdFx0Ly8gY29uc29sZS5sb2coJ2JsdXInKVxuXHRcdGlmICh0aGlzLmNsYXNzTGlzdC5jb250YWlucygnYWN0aXZlJykpIHtcblx0XHRcdGdsb2JGdW5jLnRvZ2dsZUJ1dHRvbkNvbnRlbnQodGhpcylcdFx0XHRcblx0XHR9XG5cdH0pKi9cblxuXHQkKCcuZHJvcGRvd25CdXR0b24nKS5vbignY2xpY2snLCBmdW5jdGlvbigpIHtcblx0XHRnbG9iRnVuYy50b2dnbGVCdXR0b25Db250ZW50KHRoaXMpXG5cdFx0Z2xvYkZ1bmMuZHJvcERvd24odGhpcywgZ2xvYi5uYXZNZW51V3JhcHBlcilcblx0fSlcblxuXG4gIC8vIC0tLS0tLS0tLVBvcHVwcyBCbG9jay0tLS0tLS1cblxuXHQkKCdib2R5Jykub24oJ2NsaWNrJywgJy5zZWFyY2hCdXR0b24nLCBmdW5jdGlvbigpIHtcbiAgXHQvLyBlLnByZXZlbnREZWZhdWx0KCk7XG4gIFx0bGV0IG1vZGFsID0gJCgnI3BvcHVwU2VhcmNoJyk7XG4gIFx0aWYgKCBtb2RhbC5sZW5ndGggKSB7XG4gIFx0XHRnbG9iLlBvcHVwTW9kdWxlLm9wZW5Qb3B1cChtb2RhbCwgXCJqc19vcGVuUG9wdXBfc2VhcmNoXCIpO1xuICBcdH1cbiAgfSk7XG5cbiAgJCgnYm9keScpLm9uKCdjbGljaycsICcuYnV0dG9uJywgZnVuY3Rpb24oKSB7XG4gIFx0Ly8gZS5wcmV2ZW50RGVmYXVsdCgpO1xuICBcdGxldCBtb2RhbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdpZCcpO1xuICBcdGlmICggbW9kYWwgKSB7XG4gIFx0XHRnbG9iLlBvcHVwTW9kdWxlLm9wZW5Qb3B1cChtb2RhbCk7XG4gIFx0fVxuICB9KTtcblxuICAvLyAtLS0tLS0tLS1BY2NvcmRpb24gQmxvY2tzLS0tLS0tLVxuXHQvKiQoJ2FjY29yZGlvbkJsb2NrU2VsZWN0b3InKS5vbignY2xpY2snLCAnLmJ1dHRvblNlbGVjdG9yJywgZnVuY3Rpb24oZSkge1xuXHRcdC8vIGNvbnNvbGUudGltZSgnY2xpY2sgYWNjb3JkaW9uIHdvcmtpbmcgdGltZScpO1xuXG5cdFx0aWYgKGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGllbnRXaWR0aCA8IDk5Mikge1xuXHRcdFx0ZS5zdG9wUHJvcGFnYXRpb24oKTtcblx0XHRcdGxldCBzdWJtZW51QmxvY2s7XG5cdFx0XHRsZXQgYnV0dG9uID0gdGhpcztcblxuXHRcdFx0dGhpcy5jbGFzc0xpc3QuY29udGFpbnMoJ3NpZGViYXJPcGVuQnV0dG9uJykgPyBcblx0XHRcdFx0c3VibWVudUJsb2NrID0gdGhpcy5wYXJlbnRFbGVtZW50Lm5leHRFbGVtZW50U2libGluZyA6IFxuXHRcdFx0XHRzdWJtZW51QmxvY2sgPSB0aGlzLm5leHRFbGVtZW50U2libGluZztcblxuXHRcdC8vIGxldCBzaWJsaW5nc0Jsb2NrcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJyNwdWJsaWNJbmZvUGFnZSBhcnRpY2xlLnB1YmxpY0luZm8tYmxvY2sgLnRpdGxlQmxvY2sgKyAuaGlkZGVuQ29udGVudCcpO1xuXG5cdFx0XHRnbG9iRnVuYy50b2dnbGVCdXR0b25Db250ZW50KGJ1dHRvbik7XG5cdFx0XHRnbG9iLkFjY29yZGlvbk1vZHVsZS50b2dnbGVDb250ZW50KFwid2l0aG91dFNpYmxpbmdzXCIsIGJ1dHRvbiwgc3VibWVudUJsb2NrICk7XG5cdFx0XHQvLyBBY2NvcmRpb25Nb2R1bGUudG9nZ2xlQ29udGVudChcIndpdGhTaWJsaW5nc1wiLCBidXR0b24sIHN1Ym1lbnVCbG9jaywgc2libGluZ3NCbG9ja3MgKTtcdFx0XHRcdFxuXG5cdFx0fVxuXHRcdC8vIGNvbnNvbGUudGltZUVuZCgnY2xpY2sgYWNjb3JkaW9uIHdvcmtpbmcgdGltZScpO1xuXHR9KSovXG5cbiAgLy8gLS0tLS0tLS0tVGV4dCBMaW1pdC0tLS0tLS1cblx0LypsZXQgdGV4dEJsb2NrcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5zZWxlY3RvcicpO1xuXHR0ZXh0QmxvY2tzLmxlbmd0aCA/IFRleHRMaW1pdE1vZHVsZS5zbGljZVRleHQodGV4dEJsb2NrcywgMTgwKSA6IG51bGw7Ki9cblx0JChcIi5kZXNjcmlwdGlvbiAuZWxsaXBzaXNcIikuZG90ZG90ZG90KHtcdGhlaWdodDogODAsXHR0cnVuY2F0ZTogXCJ3b3JkXCIsXHR3YXRjaDogdHJ1ZX0pO1xuXHQkKFwiLnRpdGxlLmVsbGlwc2lzXCIpLmRvdGRvdGRvdCh7XHRoZWlnaHQ6IDg1LFx0dHJ1bmNhdGU6IFwid29yZFwiLFx0d2F0Y2g6IHRydWV9KTtcblx0XG5cblx0Ly8gLS0tLS0tLS0tLVNjcm9sbC10byBTZWN0aW9uLS0tLS0tLS0tLS0tLS0tXG5cdFxuXHQvKiQoJ2JvZHknKS5vbignY2xpY2snLCAnYXJ0aWNsZS5zdG9yeS1pdGVtJywgZnVuY3Rpb24oKSB7XG5cdFx0XG5cdFx0JCgnaHRtbCwgYm9keScpLmFuaW1hdGUoe1xuXHRcdFx0c2Nyb2xsVG9wOiAkKFwiI1wiICsgJCh0aGlzKS5hdHRyKCdkYXRhLXN0b3J5LWlkJykgKS5vZmZzZXQoKS50b3Bcblx0XHR9LCA1MDApO1xuXHR9KSovXG5cblx0Ly8gLS0tLS0tLS0tLSBTdGlja3kgYmxvY2stLS0tLS0tLS0tLS0tLS1cblx0Lyp2YXIgc3RpY2t5QXNpZGVCbG9jayA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2FzaWRlLnN0aWNreScpO1xuXG5cdGlmICggc3RpY2t5QXNpZGVCbG9jayAmJiBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xpZW50V2lkdGggPiA5OTEgKSB7XG5cdFx0dmFyIHRhcmdldFN0aWNrQmxvY2sgPSBzdGlja3lBc2lkZUJsb2NrLmZpcnN0RWxlbWVudENoaWxkO1xuXHRcdGxldCByZWxhdGl2ZUJsb2NrID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoc3RpY2t5QXNpZGVCbG9jay5kYXRhc2V0LnN0aWNrVG8pXG5cblx0XHRnbG9iLlN0aWNreUJsb2NrTW9kdWxlLnRvU3RpY2sodGFyZ2V0U3RpY2tCbG9jaywgcmVsYXRpdmVCbG9jayk7XHRcdFxuXHR9Ki9cblxuXHQvLyAtLS0tLS0tLS1DbGVhbiBlbXB0eSBUYWdzLS0tLS1cblx0dmFyIHRleHRCbG9ja3MgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuZGVzY3JpcHRpb24gPiBwJyk7XG5cblx0aWYgKHRleHRCbG9ja3MubGVuZ3RoKSB7XG5cdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCB0ZXh0QmxvY2tzLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHR0ZXh0QmxvY2tzW2ldLmlubmVySFRNTCA/IG51bGwgOiB0ZXh0QmxvY2tzW2ldLnBhcmVudEVsZW1lbnQucmVtb3ZlQ2hpbGQodGV4dEJsb2Nrc1tpXSk7XG5cdFx0fVxuXHR9XG5cblx0Ly8gLS0tLS0tLVNlbGVjdC0tLS0tLS0tLS1cblx0LyokKFwiLmNob3Nlbi13cmFwcGVyIHNlbGVjdFwiKS5jaG9zZW4oe1xuXHQgIGRpc2FibGVfc2VhcmNoX3RocmVzaG9sZDogOCxcblx0ICBub19yZXN1bHRzX3RleHQ6IFwi0J3QuNGH0LXQs9C+INC90LUg0L3QsNC50LTQtdC90L4hXCIsXG5cdCAgd2lkdGg6IFwiMTAwJVwiXG5cdH0pOyovXG5cblxuXG5cdC8vID09PT09PT09PT09SW5pdGlhbGl6YXRpb25zPT09PT09PT09PT09PVxuXHR2YXIgdyA9IHdpbmRvdy5pbm5lcldpZHRoXG5cdHx8IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGllbnRXaWR0aFxuXHR8fCBkb2N1bWVudC5ib2R5LmNsaWVudFdpZHRoO1xuXHRpZiAoIHcgPCA3NjggKXtcblx0XHQkKCcuc2xpZGVzaG93Jykuc2xpY2soeyBcblx0XHRcdGRvdHM6IHRydWUsXG5cdFx0XHRpbmZpbml0ZTogdHJ1ZSxcblx0XHRcdHNwZWVkOiA1MDAsXG5cdFx0XHRmYWRlOiB0cnVlLFxuXHRcdFx0Y3NzRWFzZTogJ2xpbmVhcidcblx0XHR9KTtcblxuXHRcdCQoJy5zbGlkZScpLnNsaWNrKHsgXG5cdFx0XHQvLyBkb3RzOiB0cnVlLFxuXHRcdFx0Ly8gaW5maW5pdGU6IHRydWUsXG5cdFx0XHQvLyBzcGVlZDogNTAwLFxuXHRcdFx0Ly8gZmFkZTogdHJ1ZSxcblx0XHRcdC8vIGNzc0Vhc2U6ICdsaW5lYXInLFxuXHRcdFx0Ly8gY29sdW1uOiAyLFxuXHRcdFx0Ly8gc2xpZGVzVG9TaG93OiAyLFxuXHRcdFx0Ly8gc2xpZGVzVG9TY3JvbGw6IDIsXG5cdFx0XHRkb3RzOiB0cnVlLFxuXHRcdFx0aW5maW5pdGU6IGZhbHNlLFxuXHRcdFx0c3BlZWQ6IDUwMCxcblx0XHRcdHNsaWRlc1RvU2hvdzogNCxcblx0XHRcdHNsaWRlc1RvU2Nyb2xsOiA0LFxuXHRcdFx0cmVzcG9uc2l2ZTogW1xuXHRcdFx0ICB7XG5cdFx0XHRcdGJyZWFrcG9pbnQ6IDEwMjQsXG5cdFx0XHRcdHNldHRpbmdzOiB7XG5cdFx0XHRcdCAgc2xpZGVzVG9TaG93OiAzLFxuXHRcdFx0XHQgIHNsaWRlc1RvU2Nyb2xsOiAzLFxuXHRcdFx0XHQgIGluZmluaXRlOiB0cnVlLFxuXHRcdFx0XHQgIGRvdHM6IHRydWVcblx0XHRcdFx0fVxuXHRcdFx0ICB9LFxuXHRcdFx0ICB7XG5cdFx0XHRcdGJyZWFrcG9pbnQ6IDYwMCxcblx0XHRcdFx0c2V0dGluZ3M6IHtcblx0XHRcdFx0ICBzbGlkZXNUb1Nob3c6IDIsXG5cdFx0XHRcdCAgc2xpZGVzVG9TY3JvbGw6IDJcblx0XHRcdFx0fVxuXHRcdFx0ICB9LFxuXHRcdFx0ICB7XG5cdFx0XHRcdGJyZWFrcG9pbnQ6IDQ4MCxcblx0XHRcdFx0c2V0dGluZ3M6IHtcblx0XHRcdFx0ICBzbGlkZXNUb1Nob3c6IDEsXG5cdFx0XHRcdCAgc2xpZGVzVG9TY3JvbGw6IDFcblx0XHRcdFx0fVxuXHRcdFx0ICB9XG5cdFx0XHRdXG5cdFx0fSk7XG5cdH1cblx0XG5cblxufSk7XG5cblxud2luZG93Lm9ubG9hZCA9IGZ1bmN0aW9uKCkge1xuXHRjb25zb2xlLmxvZygnd2luZG93IGxvYWQnKVxuXHQvLyAkKCcjcGFnZS1wcmVsb2FkZXInKS5mYWRlT3V0KCdzbG93Jyk7XG5cblx0Ly8gZ2xvYi5MYXp5TG9hZE1vZHVsZS5pbml0TGF6eSgnbGF6eUJsb2NrJylcbn1cbiJdfQ==
